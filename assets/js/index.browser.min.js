/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/@dotlottie/dotlottie-js@1.6.0/dist/index.browser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{unzip,strFromU8,strToU8,zip}from"fflate";import{object,string,optional,array,literal,union,number,boolean,nativeEnum,record,any,safeParse,flatten}from"valibot";var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__defNormalProp=(t,e,i)=>e in t?__defProp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,__commonJS=(t,e)=>function(){return e||(0,t[__getOwnPropNames(t)[0]])((e={exports:{}}).exports,e),e.exports},__copyProps=(t,e,i,a)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let o of __getOwnPropNames(e))__hasOwnProp.call(t,o)||o===i||__defProp(t,o,{get:()=>e[o],enumerable:!(a=__getOwnPropDesc(e,o))||a.enumerable});return t},__toESM=(t,e,i)=>(i=null!=t?__create(__getProtoOf(t)):{},__copyProps(!e&&t&&t.__esModule?i:__defProp(i,"default",{value:t,enumerable:!0}),t)),__publicField=(t,e,i)=>__defNormalProp(t,"symbol"!=typeof e?e+"":e,i),require_ieee754=__commonJS({"../../node_modules/.pnpm/ieee754@1.2.1/node_modules/ieee754/index.js"(t){t.read=function(t,e,i,a,o){var n,r,s=8*o-a-1,c=(1<<s)-1,l=c>>1,m=-7,h=i?o-1:0,f=i?-1:1,d=t[e+h];for(h+=f,n=d&(1<<-m)-1,d>>=-m,m+=s;m>0;n=256*n+t[e+h],h+=f,m-=8);for(r=n&(1<<-m)-1,n>>=-m,m+=a;m>0;r=256*r+t[e+h],h+=f,m-=8);if(0===n)n=1-l;else{if(n===c)return r?NaN:1/0*(d?-1:1);r+=Math.pow(2,a),n-=l}return(d?-1:1)*r*Math.pow(2,n-a)},t.write=function(t,e,i,a,o,n){var r,s,c,l=8*n-o-1,m=(1<<l)-1,h=m>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=a?0:n-1,u=a?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,r=m):(r=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-r))<1&&(r--,c*=2),(e+=r+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(r++,c/=2),r+h>=m?(s=0,r=m):r+h>=1?(s=(e*c-1)*Math.pow(2,o),r+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,o),r=0));o>=8;t[i+d]=255&s,d+=u,s/=256,o-=8);for(r=r<<o|s,l+=o;l>0;t[i+d]=255&r,d+=u,r/=256,l-=8);t[i+d-u]|=128*p}}}),require_dist=__commonJS({"../../node_modules/.pnpm/@rgba-image+copy@0.1.3/node_modules/@rgba-image/copy/dist/index.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.copy=void 0;t.copy=(t,e,i=0,a=0,o=t.width-i,n=t.height-a,r=0,s=0)=>{if(i|=0,a|=0,n|=0,r|=0,s|=0,(o|=0)<=0||n<=0)return;const c=new Uint32Array(t.data.buffer),l=new Uint32Array(e.data.buffer);for(let m=0;m<n;m++){const n=a+m;if(n<0||n>=t.height)continue;const h=s+m;if(!(h<0||h>=e.height))for(let a=0;a<o;a++){const o=i+a;if(o<0||o>=t.width)continue;const s=r+a;if(s<0||s>=e.width)continue;const m=n*t.width+o;l[h*e.width+s]=c[m]}}}}}),require_dist2=__commonJS({"../../node_modules/.pnpm/@rgba-image+create-image@0.1.1/node_modules/@rgba-image/create-image/dist/index.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CreateImageFactory=(t=[0,0,0,0],e=4)=>{if(e=Math.floor(e),isNaN(e)||e<1)throw TypeError("channels should be a positive non-zero number");if(!("length"in t)||t.length<e)throw TypeError(`fill should be iterable with at least ${e} members`);const i=(t=new Uint8ClampedArray(t).slice(0,e)).every((t=>0===t));return(a,o,n)=>{if(void 0===a||void 0===o)throw TypeError("Not enough arguments");if(a=Math.floor(a),o=Math.floor(o),isNaN(a)||a<1||isNaN(o)||o<1)throw TypeError("Index or size is negative or greater than the allowed amount");const r=a*o*e;if(void 0===n&&(n=new Uint8ClampedArray(r)),n instanceof Uint8ClampedArray){if(n.length!==r)throw TypeError("Index or size is negative or greater than the allowed amount");if(!i)for(let i=0;i<o;i++)for(let o=0;o<a;o++){const r=(i*a+o)*e;for(let i=0;i<e;i++)n[r+i]=t[i]}return{get width(){return a},get height(){return o},get data(){return n}}}throw TypeError("Expected data to be Uint8ClampedArray or undefined")}},t.createImage=t.CreateImageFactory()}}),require_filters=__commonJS({"../../node_modules/.pnpm/@rgba-image+lanczos@0.1.1/node_modules/@rgba-image/lanczos/dist/filters.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.filters=void 0;var e=(t,e)=>{if(t<=-e||t>=e)return 0;if(0==t)return 0;const i=t*Math.PI;return Math.sin(i)/i*Math.sin(i/e)/(i/e)},i=t=>Math.round(16383*t);t.filters=(t,a,o,n,r)=>{const s=r?2:3,c=1/o,l=Math.min(1,o),m=s/l,h=Math.floor(2*(m+1)),f=new Int16Array((h+2)*a);let d=0;for(let o=0;o<a;o++){const r=(o+.5)*c+n,h=Math.max(0,Math.floor(r-m)),u=Math.min(t-1,Math.ceil(r+m)),p=u-h+1,g=new Float32Array(p),w=new Int16Array(p);let _=0,y=0;for(let t=h;t<=u;t++){const i=e((t+.5-r)*l,s);_+=i,g[y]=i,y++}let b=0;for(let t=0;t<g.length;t++){const e=g[t]/_;b+=e,w[t]=i(e)}w[a>>1]+=i(1-b);let A=0;for(;A<w.length&&0===w[A];)A++;let x=w.length-1;for(;x>0&&0===w[x];)x--;const v=h+A,S=x-A+1;f[d++]=v,f[d++]=S,f.set(w.subarray(A,x+1),d),d+=S}return f}}}),require_convolve=__commonJS({"../../node_modules/.pnpm/@rgba-image+lanczos@0.1.1/node_modules/@rgba-image/lanczos/dist/convolve.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convolve=void 0;t.convolve=(t,e,i,a,o,n)=>{let r=0,s=0;for(let c=0;c<a;c++){let l=0;for(let i=0;i<o;i++){let i=r+4*n[l++]|0,o=0,c=0,m=0,h=0;for(let e=n[l++];e>0;e--){const e=n[l++];o=o+e*t[i]|0,c=c+e*t[i+1]|0,m=m+e*t[i+2]|0,h=h+e*t[i+3]|0,i=i+4|0}e[s]=o+8192>>14,e[s+1]=c+8192>>14,e[s+2]=m+8192>>14,e[s+3]=h+8192>>14,s=s+4*a|0}s=4*(c+1)|0,r=(c+1)*i*4|0}}}}),require_dist3=__commonJS({"../../node_modules/.pnpm/@rgba-image+lanczos@0.1.1/node_modules/@rgba-image/lanczos/dist/index.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.lanczos2=t.lanczos=void 0;var e=require_dist(),i=require_dist2(),a=require_filters(),o=require_convolve(),n=(t,e,i=!1)=>{const n=e.width/t.width,r=e.height/t.height,s=a.filters(t.width,e.width,n,0,i),c=a.filters(t.height,e.height,r,0,i),l=new Uint8ClampedArray(e.width*t.height*4);o.convolve(t.data,l,t.width,t.height,e.width,s),o.convolve(l,e.data,t.height,e.width,e.height,c)};t.lanczos=(t,a,o=0,r=0,s=t.width-o,c=t.height-r,l=0,m=0,h=a.width-l,f=a.height-m)=>{if(r|=0,c|=0,l|=0,m|=0,h|=0,f|=0,(s|=0)<=0||c<=0||h<=0||f<=0)return;if(0===(o|=0)&&0===r&&s===t.width&&c===t.height&&0===l&&0===m&&h===a.width&&f===a.height)return void n(t,a);const d=i.createImage(s,c),u=i.createImage(h,f);e.copy(t,d,o,r),n(d,u),e.copy(u,a,0,0,u.width,u.height,l,m)};t.lanczos2=(t,a,o=0,r=0,s=t.width-o,c=t.height-r,l=0,m=0,h=a.width-l,f=a.height-m)=>{if(r|=0,c|=0,l|=0,m|=0,h|=0,f|=0,(s|=0)<=0||c<=0||h<=0||f<=0)return;if(0===(o|=0)&&0===r&&s===t.width&&c===t.height&&0===l&&0===m&&h===a.width&&f===a.height)return void n(t,a,!0);const d=i.createImage(s,c),u=i.createImage(h,f);e.copy(t,d,o,r),n(d,u,!0),e.copy(u,a,0,0,u.width,u.height,l,m)}}});function dv(t){return new DataView(t.buffer,t.byteOffset)}__toESM(require_ieee754(),1);var UINT8={len:1,get:(t,e)=>dv(t).getUint8(e),put:(t,e,i)=>(dv(t).setUint8(e,i),e+1)},UINT16_LE={len:2,get:(t,e)=>dv(t).getUint16(e,!0),put:(t,e,i)=>(dv(t).setUint16(e,i,!0),e+2)},UINT16_BE={len:2,get:(t,e)=>dv(t).getUint16(e),put:(t,e,i)=>(dv(t).setUint16(e,i),e+2)},UINT32_LE={len:4,get:(t,e)=>dv(t).getUint32(e,!0),put:(t,e,i)=>(dv(t).setUint32(e,i,!0),e+4)},UINT32_BE={len:4,get:(t,e)=>dv(t).getUint32(e),put:(t,e,i)=>(dv(t).setUint32(e,i),e+4)},INT32_BE={len:4,get:(t,e)=>dv(t).getInt32(e),put:(t,e,i)=>(dv(t).setInt32(e,i),e+4)},UINT64_LE={len:8,get:(t,e)=>dv(t).getBigUint64(e,!0),put:(t,e,i)=>(dv(t).setBigUint64(e,i,!0),e+8)},StringType=class{constructor(t,e){this.len=t,this.encoding=e,this.textDecoder=new TextDecoder(e)}get(t,e){return this.textDecoder.decode(t.subarray(e,e+this.len))}},defaultMessages="End-Of-Stream",EndOfStreamError=class extends Error{constructor(){super(defaultMessages)}},AbstractStreamReader=class{constructor(){this.maxStreamReadSize=1048576,this.endOfStream=!1,this.peekQueue=[]}async peek(t,e,i){const a=await this.read(t,e,i);return this.peekQueue.push(t.subarray(e,e+a)),a}async read(t,e,i){if(0===i)return 0;let a=this.readFromPeekBuffer(t,e,i);if(a+=await this.readRemainderFromStream(t,e+a,i-a),0===a)throw new EndOfStreamError;return a}readFromPeekBuffer(t,e,i){let a=i,o=0;for(;this.peekQueue.length>0&&a>0;){const i=this.peekQueue.pop();if(!i)throw new Error("peekData should be defined");const n=Math.min(i.length,a);t.set(i.subarray(0,n),e+o),o+=n,a-=n,n<i.length&&this.peekQueue.push(i.subarray(n))}return o}async readRemainderFromStream(t,e,i){let a=i,o=0;for(;a>0&&!this.endOfStream;){const i=Math.min(a,this.maxStreamReadSize),n=await this.readFromStream(t,e+o,i);if(0===n)break;o+=n,a-=n}return o}},WebStreamReader=class extends AbstractStreamReader{constructor(t){super(),this.reader=t.getReader({mode:"byob"})}async readFromStream(t,e,i){if(this.endOfStream)throw new EndOfStreamError;const a=await this.reader.read(new Uint8Array(i));return a.done&&(this.endOfStream=a.done),a.value?(t.set(a.value,e),a.value.byteLength):0}async abort(){await this.reader.cancel(),this.reader.releaseLock()}},AbstractTokenizer=class{constructor(t){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=t?.fileInfo??{},this.onClose=t?.onClose,t?.abortSignal&&t.abortSignal.addEventListener("abort",(()=>{this.abort()}))}async readToken(t,e=this.position){const i=new Uint8Array(t.len);if(await this.readBuffer(i,{position:e})<t.len)throw new EndOfStreamError;return t.get(i,0)}async peekToken(t,e=this.position){const i=new Uint8Array(t.len);if(await this.peekBuffer(i,{position:e})<t.len)throw new EndOfStreamError;return t.get(i,0)}async readNumber(t){if(await this.readBuffer(this.numBuffer,{length:t.len})<t.len)throw new EndOfStreamError;return t.get(this.numBuffer,0)}async peekNumber(t){if(await this.peekBuffer(this.numBuffer,{length:t.len})<t.len)throw new EndOfStreamError;return t.get(this.numBuffer,0)}async ignore(t){if(void 0!==this.fileInfo.size){const e=this.fileInfo.size-this.position;if(t>e)return this.position+=e,e}return this.position+=t,t}async close(){await this.abort(),await(this.onClose?.())}normalizeOptions(t,e){if(e&&void 0!==e.position&&e.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return e?{mayBeLess:!0===e.mayBeLess,offset:e.offset?e.offset:0,length:e.length?e.length:t.length-(e.offset?e.offset:0),position:e.position?e.position:this.position}:{mayBeLess:!1,offset:0,length:t.length,position:this.position}}abort(){return Promise.resolve()}},maxBufferSize=256e3,ReadStreamTokenizer=class extends AbstractTokenizer{constructor(t,e){super(e),this.streamReader=t}async readBuffer(t,e){const i=this.normalizeOptions(t,e),a=i.position-this.position;if(a>0)return await this.ignore(a),this.readBuffer(t,e);if(a<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===i.length)return 0;const o=await this.streamReader.read(t,i.offset,i.length);if(this.position+=o,(!e||!e.mayBeLess)&&o<i.length)throw new EndOfStreamError;return o}async peekBuffer(t,e){const i=this.normalizeOptions(t,e);let a=0;if(i.position){const e=i.position-this.position;if(e>0){const o=new Uint8Array(i.length+e);return a=await this.peekBuffer(o,{mayBeLess:i.mayBeLess}),t.set(o.subarray(e),i.offset),a-e}if(e<0)throw new Error("Cannot peek from a negative offset in a stream")}if(i.length>0){try{a=await this.streamReader.peek(t,i.offset,i.length)}catch(t){if(e?.mayBeLess&&t instanceof EndOfStreamError)return 0;throw t}if(!i.mayBeLess&&a<i.length)throw new EndOfStreamError}return a}async ignore(t){const e=Math.min(maxBufferSize,t),i=new Uint8Array(e);let a=0;for(;a<t;){const o=t-a,n=await this.readBuffer(i,{length:Math.min(e,o)});if(n<0)return n;a+=n}return a}abort(){return this.streamReader.abort()}},BufferTokenizer=class extends AbstractTokenizer{constructor(t,e){super(e),this.uint8Array=t,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:t.length}async readBuffer(t,e){if(e?.position){if(e.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=e.position}const i=await this.peekBuffer(t,e);return this.position+=i,i}async peekBuffer(t,e){const i=this.normalizeOptions(t,e),a=Math.min(this.uint8Array.length-i.position,i.length);if(!i.mayBeLess&&a<i.length)throw new EndOfStreamError;return t.set(this.uint8Array.subarray(i.position,i.position+a),i.offset),a}close(){return super.close()}};function fromWebStream(t,e){return new ReadStreamTokenizer(new WebStreamReader(t),e)}function fromBuffer(t,e){return new BufferTokenizer(t,e)}function getUintBE(t){const{byteLength:e}=t;return 6===e?t.getUint16(0)*2**32+t.getUint32(2):5===e?t.getUint8(0)*2**32+t.getUint32(1):4===e?t.getUint32(0):3===e?65536*t.getUint8(0)+t.getUint16(1):2===e?t.getUint16(0):1===e?t.getUint8(0):void 0}function indexOf(t,e){const i=t.length,a=e.length;if(0===a)return-1;if(a>i)return-1;const o=i-a;for(let i=0;i<=o;i++){let o=!0;for(let n=0;n<a;n++)if(t[i+n]!==e[n]){o=!1;break}if(o)return i}return-1}function includes(t,e){return-1!==indexOf(t,e)}function stringToBytes(t){return[...t].map((t=>t.charCodeAt(0)))}function tarHeaderChecksumMatches(t,e=0){const i=Number.parseInt(new StringType(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(i))return!1;let a=256;for(let i=e;i<e+148;i++)a+=t[i];for(let i=e+156;i<e+512;i++)a+=t[i];return i===a}new globalThis.TextDecoder("utf8"),new globalThis.TextEncoder,Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));var uint32SyncSafeToken={get:(t,e)=>127&t[e+3]|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},extensions=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx","vtt","apk"],mimeTypes=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","video/ogg","audio/ogg","audio/ogg; codecs=opus","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","text/vtt","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio","application/vnd.android.package-archive"],reasonableDetectionSizeInBytes=4100;async function fileTypeFromBuffer(t){return(new FileTypeParser).fromBuffer(t)}function _check(t,e,i){i={offset:0,...i};for(const[a,o]of e.entries())if(i.mask){if(o!==(i.mask[a]&t[a+i.offset]))return!1}else if(o!==t[a+i.offset])return!1;return!0}var FileTypeParser=class{constructor(t){this.detectors=t?.customDetectors,this.tokenizerOptions={abortSignal:t?.signal},this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(t){const e=t.position;for(const i of this.detectors||[]){const a=await i(t);if(a)return a;if(e!==t.position)return}return this.parse(t)}async fromBuffer(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(e?.length>1)return this.fromTokenizer(fromBuffer(e,this.tokenizerOptions))}async fromBlob(t){return this.fromStream(t.stream())}async fromStream(t){const e=await fromWebStream(t,this.tokenizerOptions);try{return await this.fromTokenizer(e)}finally{await e.close()}}async toDetectionStream(t,e){const{sampleSize:i=reasonableDetectionSizeInBytes}=e;let a,o;const n=t.getReader({mode:"byob"});try{const{value:t,done:e}=await n.read(new Uint8Array(i));if(o=t,!e&&t)try{a=await this.fromBuffer(t.slice(0,i))}catch(t){if(!(t instanceof EndOfStreamError))throw t;a=void 0}o=t}finally{n.releaseLock()}const r=new TransformStream({async start(t){t.enqueue(o)},transform(t,e){e.enqueue(t)}}),s=t.pipeThrough(r);return s.fileType=a,s}check(t,e){return _check(this.buffer,t,e)}checkString(t,e){return this.check(stringToBytes(t),e)}async parse(t){if(this.buffer=new Uint8Array(reasonableDetectionSizeInBytes),void 0===t.fileInfo.size&&(t.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=t,await t.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await t.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(t);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await t.ignore(6);const e=await t.readToken(uint32SyncSafeToken);return t.position+e>t.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await t.ignore(e),this.fromTokenizer(t))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===this.buffer[0]||70===this.buffer[0])&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;t.position+30<t.fileInfo.size;){await t.readBuffer(this.buffer,{length:30});const i=new DataView(this.buffer.buffer),a={compressedSize:i.getUint32(18,!0),uncompressedSize:i.getUint32(22,!0),filenameLength:i.getUint16(26,!0),extraFieldLength:i.getUint16(28,!0)};if(a.filename=await t.readToken(new StringType(a.filenameLength,"utf-8")),await t.ignore(a.extraFieldLength),/classes\d*\.dex/.test(a.filename))return{ext:"apk",mime:"application/vnd.android.package-archive"};if("META-INF/mozilla.rsa"===a.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(a.filename.endsWith(".rels")||a.filename.endsWith(".xml")){switch(a.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"}}}if(a.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(a.filename.startsWith("3D/")&&a.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===a.filename&&a.compressedSize===a.uncompressedSize){let o=await t.readToken(new StringType(a.compressedSize,"utf-8"));switch(o=o.trim(),o){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}}if(0===a.compressedSize){let n=-1;for(;n<0&&t.position<t.fileInfo.size;)await t.peekBuffer(this.buffer,{mayBeLess:!0}),n=indexOf(this.buffer,new Uint8Array([80,75,3,4])),await t.ignore(n>=0?n:this.buffer.length)}else await t.ignore(a.compressedSize)}}catch(r){if(!(r instanceof EndOfStreamError))throw r}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await t.ignore(28);const s=new Uint8Array(8);return await t.readBuffer(s),_check(s,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/ogg; codecs=opus"}:_check(s,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(s,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(s,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(s,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(s,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(3===this.buffer[2]||5===this.buffer[2]||7===this.buffer[2])&&(4===this.buffer[3]||6===this.buffer[3]||8===this.buffer[3]))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&96&this.buffer[8]){const c=new StringType(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(c){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return c.startsWith("3g")?c.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await t.ignore(1350);const l=10485760,m=new Uint8Array(Math.min(l,t.fileInfo.size));if(await t.readBuffer(m,{mayBeLess:!0}),includes(m,(new TextEncoder).encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(h){if(!(h instanceof EndOfStreamError))throw h}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const f=await this.readTiffHeader(!1);if(f)return f}if(this.check([77,77])){const d=await this.readTiffHeader(!0);if(d)return d}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function u(){const e=await t.peekNumber(UINT8);let i=128,a=0;for(;!(e&i)&&0!==i;)++a,i>>=1;const o=new Uint8Array(a+1);return await t.readBuffer(o),o}async function p(){const t=await u(),e=await u();e[0]^=128>>e.length-1;const i=Math.min(6,e.length),a=new DataView(t.buffer),o=new DataView(e.buffer,e.length-i,i);return{id:getUintBE(a),len:getUintBE(o)}}async function g(e){for(;e>0;){const i=await p();if(17026===i.id){return(await t.readToken(new StringType(i.len))).replaceAll(/\00.*$/g,"")}await t.ignore(i.len),--e}}const w=await p();switch(await g(w.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(0===this.buffer[6]||1===this.buffer[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const _=new StringType(4,"latin1").get(this.buffer,2);if(_.match("^d*")&&_>=1e3&&_<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>")){await t.ignore(8);return"debian-binary"===await t.readToken(new StringType(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"}}if(this.checkString("WEBVTT")&&["\n","\r","\t"," ","\0"].some((t=>this.checkString(t,{offset:6}))))return{ext:"vtt",mime:"text/vtt"};if(this.check([137,80,78,71,13,10,26,10])){async function y(){return{length:await t.readToken(INT32_BE),type:await t.readToken(new StringType(4,"latin1"))}}await t.ignore(8);do{const b=await y();if(b.length<0)return;switch(b.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await t.ignore(b.length+4)}}while(t.position+8<t.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function A(){const e=new Uint8Array(16);return await t.readBuffer(e),{id:e,size:Number(await t.readToken(UINT64_LE))}}for(await t.ignore(30);t.position+24<t.fileInfo.size;){const x=await A();let v=x.size-24;if(_check(x.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const S=new Uint8Array(16);if(v-=await t.readBuffer(S),_check(S,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(S,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await t.ignore(v)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10])){await t.ignore(20);switch(await t.readToken(new StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await t.peekBuffer(this.buffer,{length:Math.min(256,t.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("**ACE",{offset:7})&&this.checkString("**",{offset:12}))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const L=new DataView(this.buffer.buffer).getUint32(12,!0);if(L>12&&this.buffer.length>=L+16)try{const D=(new TextDecoder).decode(this.buffer.slice(16,L+16));if(JSON.parse(D).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await t.peekBuffer(this.buffer,{length:Math.min(512,t.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(t){const e=await this.tokenizer.readToken(t?UINT16_BE:UINT16_LE);switch(this.tokenizer.ignore(10),e){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(t){const e=await this.tokenizer.readToken(t?UINT16_BE:UINT16_LE);for(let i=0;i<e;++i){const e=await this.readTiffTag(t);if(e)return e}}async readTiffHeader(t){const e=(t?UINT16_BE:UINT16_LE).get(this.buffer,2),i=(t?UINT32_BE:UINT32_LE).get(this.buffer,4);if(42===e){if(i>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(i>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}await this.tokenizer.ignore(i);return await this.readTiffIFD(t)??{ext:"tif",mime:"image/tiff"}}if(43===e)return{ext:"tif",mime:"image/tiff"}}};new Set(extensions),new Set(mimeTypes);var ErrorCodes=(t=>(t.ASSET_NOT_FOUND="ASSET_NOT_FOUND",t.INVALID_DOTLOTTIE="INVALID_DOTLOTTIE",t.INVALID_STATEMACHINE="INVALID_STATEMACHINE",t.INVALID_URL="INVALID_URL",t))(ErrorCodes||{}),DotLottieError=class extends Error{constructor(t,e){super(t),__publicField(this,"code"),this.name="[dotLottie-js]",this.code=e}},base64ToUint8Array=t=>{const e=t.substring(t.indexOf(",")+1),i="undefined"==typeof window?Buffer.from(e,"base64").toString("binary"):atob(e),a=new Uint8Array(i.length);for(let t=0;t<i.length;t+=1)a[t]=i.charCodeAt(t);return a},getMimeTypeFromUint8Data=async t=>{const e=await fileTypeFromBuffer(t);return e?.mime.toString()},getMimeTypeFromBase64=async t=>{const e=base64ToUint8Array(t),i=await fileTypeFromBuffer(e);return i?.mime.toString()},getExtensionTypeFromBase64=async t=>{const e=base64ToUint8Array(t),i=await fileTypeFromBuffer(e);return"jpg"===i?.ext.toString()?"jpeg":i?.ext.toString()},isValidURL=t=>{try{return new URL(t),!0}catch{return!1}};async function dataUrlFromU8(t){let e;if("undefined"==typeof window)e=Buffer.from(t).toString("base64");else{const i=Array.prototype.map.call(t,(t=>String.fromCharCode(t))).join("");e=window.btoa(i)}return`data:${await getMimeTypeFromUint8Data(t)};base64,${e}`}function isImageAsset(t){return"w"in t&&"h"in t&&!("xt"in t)&&"p"in t}function isAudioAsset(t){return!("h"in t)&&!("w"in t)&&"p"in t&&"e"in t&&"u"in t&&"id"in t}function isFontAsset(t){return t.startsWith("/f/")||/\.(ttf|otf|woff|woff2)$/iu.test(t)}function isFontDataUrl(t){return"string"==typeof t&&t.startsWith("data:font/")}async function unzipDotLottie(t,e=()=>!0){if(!(t instanceof Uint8Array))throw new DotLottieError("dotLottie not found","INVALID_DOTLOTTIE");return await new Promise(((i,a)=>{unzip(t,{filter:e},((t,e)=>{t&&a(t),i(e)}))}))}async function unzipDotLottieFile(t,e,i){if(!(t instanceof Uint8Array))throw new DotLottieError("Invalid dotLottie","INVALID_DOTLOTTIE");return(await unzipDotLottie(t,(t=>t.name===e&&(!i||i(t)))))[e]}async function getManifest(t){const e="manifest.json",i=(await unzipDotLottie(t,(t=>t.name===e)))[e];if(void 0!==i)return JSON.parse(strFromU8(i,!1))}async function getDotLottieVersion(t){const e=await getManifest(t);return e?.version??"1.0.0"}async function validateDotLottie(t){if(!(t instanceof Uint8Array))return{success:!1,error:"dotLottie not found"};return void 0===await getManifest(t)?{success:!1,error:"manifest.json is missing"}:{success:!0}}async function loadFromArrayBuffer(t){const e=new Uint8Array(t),i=await validateDotLottie(e);if(i.error)throw new DotLottieError(i.error,"INVALID_DOTLOTTIE");return e}async function loadFromURL(t){if(!isValidURL(t))throw new DotLottieError("Invalid url provided for .lottie file","INVALID_URL");const e=await fetch(t),i=await e.arrayBuffer(),a=new Uint8Array([80,75,3,4]);if(!new Uint8Array(i.slice(0,4)).every(((t,e)=>t===a[e])))throw new DotLottieError("Invalid .lottie file","INVALID_DOTLOTTIE");return await loadFromArrayBuffer(i)}async function getAudio(t,e,i){let a="audio/";"2"===await getDotLottieVersion(t)&&(a="u/");const o=`${a}${e}`,n=await unzipDotLottieFile(t,o,i);if(void 0!==n)return dataUrlFromU8(n)}async function getAllAudio(t,e){const i=await getDotLottieVersion(t);let a="audio/";"2"===i&&(a="u/");const o=await unzipDotLottie(t,(t=>{const i=t.name.replace(a,"");return t.name.startsWith(a)&&(!e||e({...t,name:i}))})),n={};for(const t in o){const e=o[t];if(e instanceof Uint8Array){n[t.replace(a,"")]=await dataUrlFromU8(e)}}return n}async function inlineAudioAssets(t,e){const i=new Map;for(const[t,a]of Object.entries(e))for(const e of a.assets||[])if(isAudioAsset(e)){const a=e.p;i.has(a)||i.set(a,new Set),i.get(a)?.add(t)}const a=await getAllAudio(t,(t=>i.has(t.name)));for(const[t,o]of i){const i=a[t];if(i)for(const a of o){const o=e[a];for(const e of o?.assets||[])isAudioAsset(e)&&e.p===t&&(e.p=i,e.u="",e.e=1)}}}async function getImage(t,e,i){let a="images/";"2"===await getDotLottieVersion(t)&&(a="i/");const o=`${a}${e}`,n=await unzipDotLottieFile(t,o,i);if(void 0!==n)return dataUrlFromU8(n)}var extractImageId=t=>{const e=t.split("/");if(e.length<2)return;const i=e[e.length-1];if(!i)return;const[a]=i.split(".");return a||void 0};async function getImages(t,e){const i=await getDotLottieVersion(t);let a="images/";"2"===i&&(a="i/");const o=await unzipDotLottie(t,(t=>{const i=t.name.replace(a,"");return t.name.startsWith(a)&&(!e||e({...t,name:i}))})),n={};for(const t in o){const e=o[t],i=extractImageId(t);i&&e instanceof Uint8Array&&(n[i]=await dataUrlFromU8(e))}return n}async function inlineImageAssets(t,e){const i=new Map;for(const[t,a]of Object.entries(e))for(const e of a.assets||[])if(isImageAsset(e)){const a=e.p;i.has(a)||i.set(a,new Set),i.get(a)?.add(t)}const a=await getImages(t,(t=>i.has(t.name)));for(const[t,o]of i){const i=a[t];if(i)for(const a of o){const o=e[a];for(const e of o?.assets||[])isImageAsset(e)&&e.p===t&&(e.p=i,e.u="",e.e=1)}}}async function getFont(t,e,i){const a=`f/${e}`,o=await unzipDotLottieFile(t,a,i);if(void 0!==o)return dataUrlFromU8(o)}async function getFonts(t,e){const i="f/",a=await unzipDotLottie(t,(t=>{const a=t.name.replace(i,"");return t.name.startsWith(i)&&(!e||e({...t,name:a}))})),o={};for(const t in a){const e=a[t],n=t.replace(i,"");n&&e instanceof Uint8Array&&(o[n]=await dataUrlFromU8(e))}return o}async function inlineFontAssets(t,e){const i=new Map;for(const[t,a]of Object.entries(e)){const e=a.fonts?.list;if(e)for(const a of e)if(a.fPath&&isFontAsset(a.fPath)&&!isFontDataUrl(a.fPath)){const e=a.fPath.replace("/f/","");i.has(e)||i.set(e,new Set),i.get(e)?.add(t)}}const a=await getFonts(t,(t=>i.has(t.name)));for(const[t,o]of i){const i=a[t];if(i)for(const a of o){const o=e[a],n=o.fonts?.list;if(n)for(const e of n)e.fPath&&e.fPath.includes(t)&&(e.fPath=i)}}}async function getAnimation(t,e,{inlineAssets:i}={},a){const o=`animations/${e}.json`,n=await unzipDotLottieFile(t,o,a);if(void 0===n)return;const r=JSON.parse(strFromU8(n,!1));if(!i)return r;const s={[e]:r};return await inlineImageAssets(t,s),await inlineAudioAssets(t,s),await inlineFontAssets(t,s),r}async function getAnimations(t,{inlineAssets:e}={},i){const a={},o=await getDotLottieVersion(t);let n="animations/";"2"===o&&(n="a/");const r=await unzipDotLottie(t,(t=>{const e=t.name.replace(n,"").replace(".json","");return t.name.startsWith(n)&&(!i||i({...t,name:e}))}));for(const t in r){const e=r[t];if(e instanceof Uint8Array){const i=t.replace(n,"").replace(".json",""),o=JSON.parse(strFromU8(e,!1));a[i]=o}}return e?(await inlineImageAssets(t,a),await inlineAudioAssets(t,a),await inlineFontAssets(t,a),a):a}async function getThemes(t,e){const i={},a=await unzipDotLottie(t,(t=>{const i=t.name.replace("t/","").replace(".json","");return t.name.startsWith("t/")&&(!e||e({...t,name:i}))}));for(const t in a){const e=a[t];if(e instanceof Uint8Array){i[t.replace("t/","").replace(".json","")]=JSON.parse(strFromU8(e,!1))}}return i}async function getTheme(t,e,i){const a=`t/${e}.json`,o=await unzipDotLottieFile(t,a,i);if(void 0!==o)return JSON.parse(strFromU8(o,!1))}async function getStateMachines(t,e){const i={},a=await unzipDotLottie(t,(t=>{const i=t.name.replace("s/","").replace(".json","");return t.name.startsWith("s/")&&(!e||e({...t,name:i}))}));for(const t in a){const e=a[t];if(e instanceof Uint8Array){i[t.replace("s/","").replace(".json","")]=strFromU8(e,!1)}}return i}async function getStateMachine(t,e,i){const a=`s/${e}.json`,o=await unzipDotLottieFile(t,a,i);if(void 0===o)return;return JSON.parse(strFromU8(o,!1))}var package_default={name:"@dotlottie/dotlottie-js",version:"1.6.0",type:"module",description:"This library helps in creating and modifying .lottie files.",repository:{type:"git",url:"git+https://github.com/dotlottie/dotlottie-js.git",directory:"packages/dotlottie-js"},homepage:"https://github.com/dotlottie/dotlottie-js#readme",bugs:"https://github.com/dotlottie/dotlottie-js/issues",author:"dotLottie",contributors:["Karam Ali <karam@lottiefiles.com>","Sam Osborne <sam@lottiefiles.com>","Jawish Hameed <jawish@lottiefiles.com>","Abdelrahman Ashraf <a.theashraf@gmail.com>"],license:"MIT",engines:{node:">=18.0.0"},main:"./dist/index.node.js",exports:{".":{node:"./dist/index.node.js",default:"./dist/index.browser.js"},"./*":"./dist/*.js"},browser:"dist/index.browser.js",types:"./dist/index.browser.d.ts",typesVersions:{"*":{"*":["dist/*","dist/index.browser.d.ts"]}},files:["dist"],scripts:{build:"tsup",dev:"tsup --watch",docs:"typedoc src",lint:"eslint --fix .","stats:eslint":"cross-env TIMING=1 eslint .","stats:ts":"tsc -p tsconfig.build.json --extendedDiagnostics",test:"pnpm run test:node && pnpm run test:browser","test:browser":"vitest --config=vitest.browser.config.js","test:node":"vitest --config=vitest.config.js","type-check":"tsc --noEmit"},dependencies:{"@lottie-animation-community/lottie-types":"^1.2.0","browser-image-hash":"^0.0.5",fflate:"^0.8.1","file-type":"^19.6.0",sharp:"^0.33.2","sharp-phash":"^2.1.0",valibot:"^0.13.1"},devDependencies:{"@types/jasmine":"4.3.5","@types/node":"22.8.7","@types/sharp":"0.31.1","@vitest/browser":"2.1.3","@vitest/coverage-v8":"2.1.3","cross-env":"7.0.3","js-base64":"3.7.5",nodemon:"2.0.20",playwright:"^1.48.2",tsup:"8.3.0",typescript:"4.7.4","vite-plugin-arraybuffer":"^0.0.8",vitest:"^2.1.3"},publishConfig:{access:"public"}},PACKAGE_NAME=`${package_default.name}@${package_default.version}`,ManifestAnimationSchema=object({id:string(),name:optional(string()),initialTheme:optional(string()),background:optional(string()),themes:optional(array(string()))}),ManifestThemeSchema=object({id:string(),name:optional(string())}),ManifestStateMachineSchema=object({id:string(),name:optional(string())}),InitialObjectSchema=object({animation:optional(string()),stateMachine:optional(string())}),ManifestSchema=object({version:string(),generator:string(),initial:optional(InitialObjectSchema),animations:array(ManifestAnimationSchema),themes:optional(array(ManifestThemeSchema)),stateMachines:optional(array(ManifestStateMachineSchema))}),NumericGuardSchema=object({type:literal("Numeric"),inputName:string(),conditionType:string(),compareTo:union([string(),number(),boolean()])}),StringGuardSchema=object({type:literal("String"),inputName:string(),conditionType:string(),compareTo:string()}),BooleanGuardSchema=object({type:literal("Boolean"),inputName:string(),conditionType:string(),compareTo:union([string(),boolean()])}),EventGuardSchema=object({type:literal("Event"),inputName:string()}),GuardSchema=union([NumericGuardSchema,StringGuardSchema,BooleanGuardSchema,EventGuardSchema]);object({value:number()}),object({value:boolean()}),object({value:string()}),object({target:optional(string())});var TransitionTransitionSchema=object({type:literal("Transition"),toState:string(),guards:optional(array(GuardSchema))}),TweenedTransitionSchema=object({type:literal("Tweened"),toState:string(),guards:optional(array(GuardSchema)),duration:number(),easing:array(number())}),TransitionsSchema=array(union([TransitionTransitionSchema,TweenedTransitionSchema])),TransitionSchema=union([TransitionTransitionSchema,TweenedTransitionSchema]),OpenUrlModes=union([string("_blank"),string("_self"),string("_parent"),string("_top"),string("_unfencedTop")]),URLActionSchema=object({type:literal("OpenUrl"),url:string(),target:OpenUrlModes}),ThemeActionSchema=object({type:literal("SetTheme"),value:string()}),IncrementSchema=object({type:literal("Increment"),inputName:string(),value:optional(union([string(),number()]))}),DecrementSchema=object({type:literal("Decrement"),inputName:string(),value:optional(union([string(),number()]))}),ToggleSchema=object({type:literal("Toggle"),inputName:string()}),SetBooleanSchema=object({type:literal("SetBoolean"),inputName:string(),value:optional(boolean())}),SetStringSchema=object({type:literal("SetString"),inputName:string(),value:optional(string())}),SetNumericSchema=object({type:literal("SetNumeric"),inputName:string(),value:optional(number())}),FireSchema=object({type:literal("Fire"),inputName:string()}),ResetSchema=object({type:literal("Reset"),inputName:string()}),SetExpressionSchema=object({type:literal("SetExpression"),layerName:string(),propertyIndex:number(),varName:string(),value:number()}),SetThemeSchema=object({type:literal("SetTheme"),themeId:string()}),SetFrameSchema=object({type:literal("SetFrame"),value:union([string(),number()])}),SetProgressSchema=object({type:literal("SetProgress"),value:union([string(),number()])}),SetSlotSchema=object({type:literal("SetSlot"),value:string()}),FireCustomEventSchema=object({type:literal("FireCustomEvent"),value:string()}),ActionSchema=union([URLActionSchema,ThemeActionSchema,IncrementSchema,DecrementSchema,ToggleSchema,SetBooleanSchema,SetStringSchema,SetNumericSchema,FireSchema,ResetSchema,SetExpressionSchema,SetThemeSchema,SetFrameSchema,SetProgressSchema,SetSlotSchema,FireCustomEventSchema]),Modes=union([literal("Forward"),literal("Reverse"),literal("Bounce"),literal("ReverseBounce")]),PlaybackStateSchema=object({name:string(),type:literal("PlaybackState"),animation:string(),loop:optional(boolean()),loopCount:optional(number()),autoplay:optional(boolean()),final:optional(boolean()),mode:optional(Modes),speed:optional(number()),segment:optional(string()),backgroundColor:optional(number()),useFrameInterpolation:optional(boolean()),entryActions:optional(array(ActionSchema)),exitActions:optional(array(ActionSchema)),transitions:optional(TransitionsSchema)}),GlobalStateSchema=object({name:string(),type:literal("GlobalState"),entryActions:optional(array(ActionSchema)),exitActions:optional(array(ActionSchema)),transitions:optional(TransitionsSchema)}),StateSchema=union([PlaybackStateSchema,GlobalStateSchema]),StatesSchema=array(StateSchema),PointerUpSchema=object({type:literal("PointerUp"),layerName:optional(string()),actions:array(ActionSchema)}),PointerDownSchema=object({type:literal("PointerDown"),layerName:optional(string()),actions:array(ActionSchema)}),PointerEnterSchema=object({type:literal("PointerEnter"),layerName:optional(string()),actions:array(ActionSchema)}),PointerMoveSchema=object({type:literal("PointerMove"),actions:array(ActionSchema)}),PointerExitSchema=object({type:literal("PointerExit"),layerName:optional(string()),actions:array(ActionSchema)}),ClickSchema=object({type:literal("Click"),layerName:optional(string()),actions:array(ActionSchema)}),OnCompleteSchema=object({type:literal("OnComplete"),stateName:string(),actions:array(ActionSchema)}),OnLoopCompleteSchema=object({type:literal("OnLoopComplete"),stateName:string(),actions:array(ActionSchema)}),InteractionSchema=union([PointerUpSchema,PointerDownSchema,PointerEnterSchema,PointerMoveSchema,PointerExitSchema,ClickSchema,OnCompleteSchema,OnLoopCompleteSchema]),InteractionsSchema=array(InteractionSchema),NumericInputSchema=object({type:literal("Numeric"),name:string(),value:number()}),StringInputSchema=object({type:literal("String"),name:string(),value:string()}),BooleanInputSchema=object({type:literal("Boolean"),name:string(),value:boolean()}),EventInputSchema=object({type:literal("Event"),name:string()}),InputSchema=union([NumericInputSchema,StringInputSchema,BooleanInputSchema,EventInputSchema]),InputsSchema=array(InputSchema),DotLottieStateMachineSchema=object({initial:string(),states:StatesSchema,interactions:optional(InteractionsSchema),inputs:optional(InputsSchema)}),TangentSchema=object({x:union([number(),array(number())]),y:union([number(),array(number())])}),BaseKeyframeSchema={frame:number(),inTangent:optional(TangentSchema),outTangent:optional(TangentSchema),hold:optional(boolean())},ScalarKeyframeSchema=object({...BaseKeyframeSchema,value:number()}),ColorKeyframeSchema=object({...BaseKeyframeSchema,value:array(number())}),BaseRuleSchema={animations:optional(array(string())),id:string()},ScalarRuleSchema=object({...BaseRuleSchema,type:literal("Scalar"),value:optional(number()),keyframes:optional(array(ScalarKeyframeSchema)),expression:optional(string())}),PositionKeyframeSchema=object({...BaseKeyframeSchema,value:array(number()),valueInTangent:optional(number()),valueOutTangent:optional(number())}),PositionRuleSchema=object({...BaseRuleSchema,type:literal("Position"),split:optional(boolean()),keyframes:optional(array(PositionKeyframeSchema)),expression:optional(string())}),VectorKeyframeSchema=object({...BaseKeyframeSchema,value:array(number())}),VectorRuleSchema=object({...BaseRuleSchema,type:literal("Vector"),value:optional(array(number())),keyframes:optional(array(VectorKeyframeSchema)),expression:optional(string())}),ColorRuleSchema=object({...BaseRuleSchema,type:literal("Color"),value:optional(array(number())),keyframes:optional(array(ColorKeyframeSchema)),expression:optional(string())}),ImageRuleSchema=object({...BaseRuleSchema,type:literal("Image"),value:object({id:optional(string()),width:optional(number()),height:optional(number()),url:optional(string())})}),GradientKeyframeSchema=object({...BaseKeyframeSchema,value:array(object({color:array(number()),offset:number()}))}),GradientRuleSchema=object({...BaseRuleSchema,type:literal("Gradient"),value:optional(array(object({color:array(number()),offset:number()}))),keyframes:optional(array(GradientKeyframeSchema))}),TextDocumentSchema=object({text:optional(string()),fontFamily:optional(string()),fontSize:optional(number()),fillColor:optional(array(number())),strokeColor:optional(array(number())),strokeWidth:optional(number()),strokeOverFill:optional(boolean()),lineHeight:optional(number()),tracking:optional(number()),justify:optional(union([literal("Left"),literal("Right"),literal("Center"),literal("JustifyLastLeft"),literal("JustifyLastRight"),literal("JustifyLastCenter"),literal("JustifyLastFull")])),textCaps:optional(union([literal("Regular"),literal("AllCaps"),literal("SmallCaps")])),baselineShift:optional(number()),wrapSize:optional(array(number())),wrapPosition:optional(array(number()))}),TextKeyframeSchema=object({frame:number(),value:TextDocumentSchema}),TextRuleSchema=object({...BaseRuleSchema,type:literal("Text"),value:optional(TextDocumentSchema),keyframes:optional(array(TextKeyframeSchema)),expression:optional(string())}),RuleSchema=union([ColorRuleSchema,ScalarRuleSchema,PositionRuleSchema,VectorRuleSchema,ImageRuleSchema,GradientRuleSchema,TextRuleSchema]),RulesSchema=array(RuleSchema),ThemeDataSchema=object({rules:RulesSchema}),DotLottieStateMachineCommon=class{constructor(t){__publicField(this,"_name"),__publicField(this,"_id"),__publicField(this,"_initial"),__publicField(this,"_zipOptions"),__publicField(this,"_states"),__publicField(this,"_interactions"),__publicField(this,"_inputs"),this._requireValidId(t.id),t.data.inputs&&this._requireValidInputs(t.data.inputs),t.data.interactions&&this._requireValidInteractions(t.data.interactions),this._requireValidStates(t.data.states),this._requireValidInitial(t.data.initial,t.data.states),this._name=t.name,this._id=t.id,this._initial=t.data.initial,this._zipOptions=t.zipOptions??{},this._states=t.data.states,this._interactions=t.data.interactions??[],this._inputs=t.data.inputs??[]}get zipOptions(){return this._zipOptions}set zipOptions(t){this._zipOptions=t}get id(){return this._id}set id(t){this._requireValidId(t),this._id=t}get name(){return this._name}set name(t){this._name=t}get states(){return this._states}set states(t){this._states=t}get interactions(){return this._interactions}set interactions(t){this._interactions=t}get inputs(){return this._inputs}set inputs(t){this._inputs=t}get initial(){return this._initial}set initial(t){this.initial=t}toString(){return JSON.stringify({initial:this._initial,states:this._states,inputs:this._inputs,interactions:this._interactions})}_requireValidId(t){if(!t)throw new DotLottieError("Invalid id.")}_requireValidInitial(t,e){const i=safeParse(StatesSchema,e);if(!i.success){const t=`${JSON.stringify(flatten(i.issues).nested,null,2)}`;throw new DotLottieError(`Invalid initial state: ${t}`,"INVALID_STATEMACHINE")}let a=!1;for(const i of e)i.name===t&&(a=!0);if(!a)throw new DotLottieError("Initial state not found.","INVALID_STATEMACHINE")}_requireValidStates(t){const e=safeParse(StatesSchema,t);if(!e.success){const t=`${JSON.stringify(flatten(e.issues).nested,null,2)}`;throw new DotLottieError(`Invalid states declaration: ${t}`,"INVALID_STATEMACHINE")}}_requireValidInputs(t){const e=safeParse(InputsSchema,t);if(!e.success){const t=`${JSON.stringify(flatten(e.issues).nested,null,2)}`;throw new DotLottieError(`Invalid inputs: ${t}`,"INVALID_STATEMACHINE")}}_requireValidInteractions(t){const e=safeParse(InteractionsSchema,t);if(!e.success){const t=`${JSON.stringify(flatten(e.issues).nested,null,2)}`;throw new DotLottieError(`Invalid interactions: ${t}`,"INVALID_STATEMACHINE")}}_requireValidTransitions(t){const e=safeParse(TransitionsSchema,t);if(!e.success){const t=`${JSON.stringify(flatten(e.issues).nested,null,2)}`;throw new DotLottieError(`Invalid transitions: ${t}`,"INVALID_STATEMACHINE")}}},LottieThemeCommon=class{constructor(t){__publicField(this,"_data"),__publicField(this,"_id"),__publicField(this,"_name"),__publicField(this,"_zipOptions"),this._requireValidId(t.id),this._requireValidData(t.data),this._name=t.name,this._data=t.data,this._id=t.id,this._zipOptions=t.zipOptions??{}}get zipOptions(){return this._zipOptions}set zipOptions(t){this._zipOptions=t}get id(){return this._id}set id(t){this._requireValidId(t),this._id=t}get name(){return this._name}set name(t){this._name=t}get data(){return this._data}set data(t){this._requireValidData(t),this._data=t}async toString(){return JSON.stringify(this._data)}_requireValidId(t){if("string"!=typeof t||!t)throw new DotLottieError("Invalid theme id")}_requireValidData(t){const e=safeParse(ThemeDataSchema,t);if(!e.success){const t=JSON.stringify(e.issues,null,2);throw new DotLottieError(`Invalid theme data: ${t}`)}}},DotLottieCommon=class{constructor(t){__publicField(this,"_animationsMap",new Map),__publicField(this,"_plugins",[]),__publicField(this,"_themesMap",new Map),__publicField(this,"_stateMachinesMap",new Map),__publicField(this,"_generator",PACKAGE_NAME),__publicField(this,"_version","2"),__publicField(this,"enableDuplicateImageOptimization"),t?.generator&&(this._generator=t.generator),this.enableDuplicateImageOptimization=t?.enableDuplicateImageOptimization??!1}async toBase64(t){throw new DotLottieError("toBase64() method not implemented in concrete class!")}create(t){throw new DotLottieError("create() method not implemented in concrete class!")}async download(t,e=void 0){throw new DotLottieError("download(fileName:string) method not implemented in concrete class!")}addPlugins(...t){throw new DotLottieError("addPlugins(...plugins: DotLottiePlugin[]) not implemented in concrete class!")}addAnimation(t){throw new DotLottieError("addAnimation(animationOptions: AnimationOptions) not implemented in concrete class!")}async fromArrayBuffer(t){throw new DotLottieError("fromArrayBuffer(arrayBuffer: ArrayBuffer): Promise<DotLottieCommon> not implemented in concrete class!")}async toArrayBuffer(t=void 0){throw new DotLottieError("toArrayBuffer(): Promise<ArrayBuffer> is not implemented in concrete class!")}get plugins(){return this._plugins}get version(){return this._version}get generator(){return this._generator}get animations(){return Array.from(this._animationsMap.values())}get manifest(){return this._buildManifest()}get themes(){return Array.from(this._themesMap.values())}get stateMachines(){return Array.from(this._stateMachinesMap.values())}async _renameImage(t,e,i){for(const a of t.imageAssets)if(a.lottieAssetId===i){const i=a.fileName;if(await a.renameImage(e),!t.data)throw new DotLottieError("No animation data available.");const o=t.data.assets;if(!o)throw new DotLottieError("No image assets to rename.");for(const t of o)"w"in t&&"h"in t&&t.p===i&&(t.p=a.fileName)}}_generateMapOfOccurencesFromImageIds(){const t=new Map;return this.animations.forEach((e=>{e.imageAssets.forEach((e=>{if(t.has(e.lottieAssetId)){const i=t.get(e.lottieAssetId)??0;t.set(e.lottieAssetId,i+1)}else t.set(e.lottieAssetId,1)}))})),t}async _renameImageAssets(){const t=this._generateMapOfOccurencesFromImageIds();for(let e=this.animations.length-1;e>=0;e-=1){const i=this.animations.at(e);if(i)for(let e=i.imageAssets.length-1;e>=0;e-=1){const a=i.imageAssets.at(e);if(a){let e=t.get(a.lottieAssetId)??0;e>0&&(e-=1),t.set(a.lottieAssetId,e),e>0&&await this._renameImage(i,`${a.lottieAssetId}_${e}`,a.lottieAssetId)}}}}async _renameAudio(t,e,i){for(const a of t.audioAssets)if(a.id===i){if(await a.renameAudio(e),!t.data)throw new DotLottieError("No animation data available.");const o=t.data.assets;if(!o)throw new DotLottieError("No audio assets to rename.");for(const t of o)isAudioAsset(t)&&t.id===i&&(t.p=a.fileName)}}async _renameAudioAssets(){const t=new Map;this.animations.forEach((e=>{t.set(e.id,e.audioAssets)}));let e=0;t.forEach((t=>{e+=t.length}));for(let t=this.animations.length-1;t>=0;t-=1){const i=this.animations.at(t);if(i)for(let t=i.audioAssets.length-1;t>=0;t-=1){const a=i.audioAssets.at(t);a&&(await this._renameAudio(i,`audio_${e}`,a.id),e-=1)}}}async _renameFont(t,e,i){for(const a of t.fontAssets)if(a.fileName===i){if(await a.renameFont(e),!t.data)throw new DotLottieError("No animation data available.");const o=t.data.fonts?.list;if(!o)throw new DotLottieError("No font list to rename.");for(const t of o)t.fPath===`/f/${i}`&&(t.fPath=`/f/${a.fileName}`)}}async _renameFontAssets(){const t=new Map;this.animations.forEach((e=>{t.set(e.id,e.fontAssets)}));let e=0;t.forEach((t=>{e+=t.length}));for(let t=this.animations.length-1;t>=0;t-=1){const i=this.animations.at(t);if(i)for(let t=i.fontAssets.length-1;t>=0;t-=1){const a=i.fontAssets.at(t);if(a){const t=a.fileName;await this._renameFont(i,`font_${e}`,t),e-=1}}}}_addLottieAnimation(t){if(this._animationsMap.get(t.id))throw new DotLottieError("Duplicate animation id detected, aborting.");return this._animationsMap.set(t.id,t),this}async _findAssetsAndInline(t){const e=t.data?.assets;if(!e)throw new DotLottieError("Failed to inline assets, the animation's assets are undefined.");const i=this.getImages(),a=this.getAudio(),o=this.getFonts();for(const t of e)if(isImageAsset(t))for(const e of i)e.fileName===t.p&&(t.e=1,t.u="",t.p=await e.toDataURL());else if(isAudioAsset(t))for(const e of a)e.fileName===t.p&&(t.e=1,t.u="",t.p=await e.toDataURL());const n=t.data?.fonts?.list;if(n)for(const t of n)for(const e of o)t.fPath===`/f/${e.fileName}`&&(t.fPath=await e.toDataURL(),t.origin=3);return t}async getAnimation(t,e){if(!e?.inlineAssets)return this._animationsMap.get(t);let i=this._animationsMap.get(t);if(!i)throw new DotLottieError("Failed to find animation.");return i=await this._findAssetsAndInline(i),i}getAnimations(){return Array.from(this._animationsMap)}removeAnimation(t){const e=this._animationsMap.get(t);if(e){const t=e.themes;for(const i of t)this.unscopeTheme({animationId:e.id,themeId:i.id});this._animationsMap.delete(e.id)}return this}getImages(){const t=[];return this.animations.map((e=>t.push(...e.imageAssets))),t}getAudio(){const t=[];return this.animations.map((e=>t.push(...e.audioAssets))),t}getFonts(){const t=[];return this.animations.map((e=>t.push(...e.fontAssets))),t}getTheme(t){return this._themesMap.get(t)}_buildManifest(){const t=Array.from(this._animationsMap.values()),e=Array.from(this._themesMap.values()),i=Array.from(this._stateMachinesMap.values()),a=t.find((t=>t.defaultActiveAnimation))?.id??"",o={version:this.version,generator:this.generator,animations:t.map((t=>({id:t.id,...t.name?{name:t.name}:{},...t.initialTheme?{initialTheme:t.initialTheme}:{},...t.background?{background:t.background}:{},...t.themes.length>0?{themes:t.themes.map((t=>t.id))}:{}})))};return e.length>0&&(o.themes=e.map((t=>({id:t.id,...t.name?{name:t.name}:{}})))),i.length>0&&(o.stateMachines=i.map((t=>({id:t.id,...t.name?{name:t.name}:{}})))),a&&(o.initial={animation:a}),o}async build(){this._buildManifest();for(const t of this.animations)await t.toJSON();this.animations.length>1&&(await this._renameImageAssets(),await this._renameAudioAssets(),await this._renameFontAssets());const t=[],e=[];for(const i of this.plugins)i.parallel?t.push(i):e.push(i);await Promise.all(t.map((async t=>t.onBuild())));for(const t of e)await t.onBuild();return this}async toBlob(t=void 0){const e=await this.toArrayBuffer(t);return new Blob([e],{type:"application/zip"})}async fromURL(t){if(!isValidURL(t))throw new DotLottieError("Invalid URL");try{const e=await fetch(t);if(!e.ok)throw new DotLottieError(e.statusText);const i=await e.arrayBuffer();return this.fromArrayBuffer(i)}catch(t){if(t instanceof Error)throw new DotLottieError(t.message)}throw new DotLottieError("Unknown error")}merge(...t){const e=this.create();for(const i of t)i.themes.forEach((t=>{e.addTheme({id:t.id,name:t.name,data:t.data})})),i.animations.forEach((t=>{t.data?e.addAnimation({id:t.id,name:t.name,data:t.data}):t.url&&e.addAnimation({id:t.id,name:t.name,url:t.url}),t.themes.forEach((i=>{e.scopeTheme({animationId:t.id,themeId:i.id})}))})),i.stateMachines.forEach((t=>{const i={id:t.id,name:t.name,data:{states:t.states,initial:t.initial,interactions:t.interactions,inputs:t.inputs},zipOptions:t.zipOptions};e.addStateMachine(i)}));return e}addTheme(t){const e=new LottieThemeCommon(t);return this._themesMap.set(e.id,e),this}removeTheme(t){const e=this._themesMap.get(t);if(e){for(const t of this.animations)t.themes.includes(e)&&t.unscopeTheme(e.id);this._themesMap.delete(e.id)}return this}scopeTheme({animationId:t,themeId:e}){const i=this._themesMap.get(e);if(!i)throw new DotLottieError(`Failed to find theme with id ${e}`);const a=this._animationsMap.get(t);if(!a)throw new DotLottieError(`Failed to find animation with id ${t}`);return a.scopeTheme(i),this}unscopeTheme({animationId:t,themeId:e}){const i=this._themesMap.get(e);if(!i)throw new DotLottieError(`Failed to find theme with id ${e}`);const a=this._animationsMap.get(t);if(!a)throw new DotLottieError(`Failed to find animation with id ${t}`);return a.unscopeTheme(i.id),this}addStateMachine(t){const e=new DotLottieStateMachineCommon(t);return this._stateMachinesMap.set(t.id,e),this}getStateMachine(t){return this._stateMachinesMap.get(t)}removeStateMachine(t){return this._stateMachinesMap.delete(t),this}_requireValidDescription(t){if("string"!=typeof t)throw new DotLottieError("Invalid description")}_requireValidGenerator(t){if("string"!=typeof t)throw new DotLottieError("Invalid generator")}_requireValidKeywords(t){if("string"!=typeof t)throw new DotLottieError("Invalid keywords")}_requireValidVersion(t){if("string"!=typeof t)throw new DotLottieError("Invalid version")}_requireValidCustomData(t){if(!t)throw new DotLottieError("Invalid customData")}},LottieAnimationCommon=class{constructor(t){__publicField(this,"_name"),__publicField(this,"_data"),__publicField(this,"_id",""),__publicField(this,"_url"),__publicField(this,"_zipOptions"),__publicField(this,"_defaultActiveAnimation"),__publicField(this,"_imageAssets",[]),__publicField(this,"_audioAssets",[]),__publicField(this,"_fontAssets",[]),__publicField(this,"_themesMap",new Map),__publicField(this,"_initialTheme",null),__publicField(this,"_background",null),this._requireValidOptions(t),this._id=t.id,this._name=t.name,this._zipOptions=t.zipOptions??{},t.data&&(this._data=t.data),t.url&&(this._url=t.url),this._background=t.background??null,this._initialTheme=t.initialTheme??null,this._defaultActiveAnimation=t.defaultActiveAnimation??!1}async toBase64(){throw new DotLottieError("lottie animation controls tobase64 not implemented!")}get zipOptions(){return this._zipOptions}set zipOptions(t){this._zipOptions=t}get id(){return this._id}set id(t){this._requireValidId(t),this._id=t}get name(){return this._name}set name(t){this._name=t}get background(){return this._background}set background(t){this._background=t}get initialTheme(){return this._initialTheme}set initialTheme(t){this._initialTheme=t}get themes(){return Array.from(this._themesMap.values())}set themes(t){this._themesMap=new Map,t.forEach((t=>{this._themesMap.set(t.id,t)}))}get imageAssets(){return this._imageAssets}set imageAssets(t){this._imageAssets=t}get audioAssets(){return this._audioAssets}set audioAssets(t){this._audioAssets=t}get fontAssets(){return this._fontAssets}set fontAssets(t){this._fontAssets=t}get data(){return this._data}set data(t){this._requireValidLottieData(t),this._data=t}get url(){return this._url}set url(t){this._requireValidUrl(t),this._url=t}get defaultActiveAnimation(){return this._defaultActiveAnimation}set defaultActiveAnimation(t){this._defaultActiveAnimation=t}scopeTheme(t){this._themesMap.set(t.id,t)}unscopeTheme(t){this._themesMap.delete(t)}async toArrayBuffer(t){const e=await this.toJSON(t);return(new TextEncoder).encode(JSON.stringify(e)).buffer}async _extractImageAssets(){throw new DotLottieError("_extractImageAssets(): Promise<boolean> method not implemented in concrete class")}async _extractAudioAssets(){throw new DotLottieError("_extractAudioAssets(): Promise<boolean> method not implemented in concrete class")}async _extractFontAssets(){throw new DotLottieError("_extractFontAssets(): Promise<boolean> method not implemented in concrete class")}async toBlob(t){const e=await this.toJSON(t);return new Blob([JSON.stringify(e)],{type:"application/json"})}async toJSON(t){if(this._url&&!this._data&&(this._data=await this._fromUrl(this._url)),this._requireValidLottieData(this._data),this._data.fonts?.list?.length&&await this._extractFontAssets(),this._data.assets?.length&&(await this._extractImageAssets(),await this._extractAudioAssets(),t?.inlineAssets)){const t=this.data?.assets;if(!t)throw new DotLottieError("Failed to inline assets, the animation's assets are undefined.");const e=this.imageAssets,i=this.audioAssets;for(const a of t)if("w"in a&&"h"in a&&!("xt"in a)&&"p"in a)for(const t of e)t.fileName===a.p&&(a.e=1,a.u="",a.p=await t.toDataURL());else if(isAudioAsset(a))for(const t of i)t.fileName===a.p&&(a.e=1,a.u="",a.p=await t.toDataURL())}return this._data}async _fromUrl(t){const e=await fetch(t),i=await e.text();let a;try{a=JSON.parse(i)}catch(t){if(t instanceof Error)throw new DotLottieError(`${t.message}: Invalid json returned from url`)}return this._requireValidLottieData(a),a}_requireValidUrl(t){try{new URL(t||"")}catch(t){throw new DotLottieError("Invalid animation url")}}_requireValidLottieData(t){if(!["v","ip","op","layers","fr","w","h"].every((e=>Object.prototype.hasOwnProperty.call(t,e))))throw new DotLottieError("Received invalid Lottie data.")}_requireValidId(t){if(!t)throw new DotLottieError("Invalid animation id")}_requireValidOptions(t){if(this._requireValidId(t.id),!t.data&&!t.url)throw new DotLottieError("No data or url provided.");t.data&&this._requireValidLottieData(t.data),t.url&&this._requireValidUrl(t.url)}},LottieImageCommon=class{constructor(t){__publicField(this,"_data"),__publicField(this,"_id",""),__publicField(this,"_lottieAssetId",""),__publicField(this,"_fileName",""),__publicField(this,"_parentAnimations"),__publicField(this,"_zipOptions"),this._requireValidId(t.id),this._requireValidLottieAssetId(t.lottieAssetId),this._requireValidFileName(t.fileName),this._zipOptions=t.zipOptions??{},t.data&&(this._data=t.data),t.id&&(this._id=t.id),t.lottieAssetId&&(this._lottieAssetId=t.lottieAssetId),t.fileName&&(this._fileName=t.fileName),this._parentAnimations=t.parentAnimations||[]}get zipOptions(){return this._zipOptions}set zipOptions(t){this._zipOptions=t}_requireValidId(t){if(!t)throw new DotLottieError("Invalid image id")}_requireValidLottieAssetId(t){if(!t)throw new DotLottieError("Invalid Lottie Image Asset Id")}_requireValidFileName(t){if(!t)throw new DotLottieError("Invalid image fileName")}get fileName(){return this._fileName}set fileName(t){this._requireValidFileName(t),this._fileName=t}get id(){return this._id}set id(t){this._requireValidId(t),this._id=t}get lottieAssetId(){return this._lottieAssetId}set lottieAssetId(t){this._requireValidLottieAssetId(t),this._lottieAssetId=t}get data(){return this._data}set data(t){if(!t)throw new DotLottieError("Invalid data");this._data=t}get parentAnimations(){return this._parentAnimations}set parentAnimations(t){this._parentAnimations=t}async toDataURL(){if(this._data&&this._isDataURL(this._data))return this.data;const t=await this.toArrayBuffer();return dataUrlFromU8(new Uint8Array(t))}async renameImage(t){this._lottieAssetId=t;const e=await this.toDataURL(),i=await getExtensionTypeFromBase64(e);if(!i)throw new DotLottieError("File extension type could not be detected from asset file.");this.fileName=`${t}.${i}`}async toArrayBuffer(){return await(await this.toBlob()).arrayBuffer()}async toBlob(){if(!this._data)throw new DotLottieError("Invalid image data.");if(this._isDataURL(this._data)){const t=this._data,[e,i]=t.split(",");if((!e||!i)&&t.length)return new Blob([t]);if(!e||!i)throw new DotLottieError("Invalid image data.");const a=e.replace("data:","").replace(/;base64$/,"");return new Blob([i],{type:a})}if(this._isArrayBuffer(this._data))return new Blob([this._data]);if(this._isBlob(this._data))return this._data;throw new DotLottieError("Invalid image data.")}async _fromUrlToBlob(t){return(await fetch(t)).blob()}_isArrayBuffer(t){return t instanceof ArrayBuffer}_isDataURL(t){return"string"==typeof t&&t.startsWith("data:")}_isBlob(t){return t instanceof Blob}},LottieAudioCommon=class{constructor(t){__publicField(this,"_data"),__publicField(this,"_id",""),__publicField(this,"_url"),__publicField(this,"_fileName",""),__publicField(this,"_parentAnimations"),__publicField(this,"_zipOptions"),this._requireValidId(t.id),this._requireValidFileName(t.fileName),this._zipOptions=t.zipOptions??{},t.data&&(this._data=t.data),t.id&&(this._id=t.id),t.url&&(this._url=t.url),t.fileName&&(this._fileName=t.fileName),this._parentAnimations=t.parentAnimations||[]}get zipOptions(){return this._zipOptions}set zipOptions(t){this._zipOptions=t}get fileName(){return this._fileName}set fileName(t){if(!t)throw new DotLottieError("Invalid audio file name","ASSET_NOT_FOUND");this._fileName=t}get id(){return this._id}set id(t){if(!t)throw new DotLottieError("Invalid audio id","ASSET_NOT_FOUND");this._id=t}get data(){return this._data}set data(t){if(!t)throw new DotLottieError("Invalid data");this._data=t}get parentAnimations(){return this._parentAnimations}set parentAnimations(t){this._parentAnimations=t}async toDataURL(){if(this._data&&this._isDataURL(this._data))return this.data;const t=await this.toArrayBuffer();return dataUrlFromU8(new Uint8Array(t))}async renameAudio(t){this.id=t;const e=await this.toDataURL(),i=await getExtensionTypeFromBase64(e);if(!i)throw new DotLottieError("File extension type could not be detected from asset file.");this.fileName=`${t}.${i}`}async toArrayBuffer(){return await(await this.toBlob()).arrayBuffer()}async toBlob(){if(!this._data&&this._url&&(this._data=await this._fromUrlToBlob(this._url)),!this._data)throw new Error("Invalid data");if(this._isDataURL(this._data)){const t=this._data,[e,i]=t.split(",");if((!e||!i)&&t.length)return new Blob([t]);if(!e||!i)throw new Error("Invalid data");const a=e.replace("data:","").replace(/;base64$/,"");return new Blob([i],{type:a})}if(this._isArrayBuffer(this._data))return new Blob([this._data]);if(this._isBlob(this._data))return this._data;throw new Error("Invalid data")}async _fromUrlToBlob(t){return(await fetch(t)).blob()}_isArrayBuffer(t){return t instanceof ArrayBuffer}_isDataURL(t){return"string"==typeof t&&t.startsWith("data:")}_isBlob(t){return t instanceof Blob}_requireValidId(t){if(!t)throw new DotLottieError("Invalid audio id")}_requireValidFileName(t){if(!t)throw new DotLottieError("Invalid audio fileName")}},LottieFontCommon=class{constructor(t){__publicField(this,"_data"),__publicField(this,"_id",""),__publicField(this,"_fileName",""),__publicField(this,"_parentAnimations"),__publicField(this,"_zipOptions"),this._requireValidId(t.id),this._requireValidFileName(t.fileName),this._zipOptions=t.zipOptions??{},t.data&&(this._data=t.data),t.id&&(this._id=t.id),t.fileName&&(this._fileName=t.fileName),this._parentAnimations=t.parentAnimations||[]}get zipOptions(){return this._zipOptions}set zipOptions(t){this._zipOptions=t}_requireValidId(t){if(!t)throw new DotLottieError("Invalid font id")}_requireValidFileName(t){if(!t)throw new DotLottieError("Invalid font fileName")}get fileName(){return this._fileName}set fileName(t){this._requireValidFileName(t),this._fileName=t}get id(){return this._id}set id(t){this._requireValidId(t),this._id=t}get data(){return this._data}set data(t){if(!t)throw new DotLottieError("Invalid data");this._data=t}get parentAnimations(){return this._parentAnimations}set parentAnimations(t){this._parentAnimations=t}async toDataURL(){if(this._data&&this._isDataURL(this._data))return this.data;const t=await this.toArrayBuffer();return dataUrlFromU8(new Uint8Array(t))}async renameFont(t){const e=await this.toDataURL(),i=await getExtensionTypeFromBase64(e);if(!i)throw new DotLottieError("File extension type could not be detected from font file.");this.fileName=`${t}.${i}`}async toArrayBuffer(){return await(await this.toBlob()).arrayBuffer()}async toBlob(){if(!this._data)throw new DotLottieError("Invalid font data.");if(this._isDataURL(this._data)){const t=this._data,[e,i]=t.split(",");if((!e||!i)&&t.length)return new Blob([t]);if(!e||!i)throw new DotLottieError("Invalid font data.");const a=e.replace("data:","").replace(/;base64$/,"");return new Blob([i],{type:a})}if(this._isArrayBuffer(this._data))return new Blob([this._data]);if(this._isBlob(this._data))return this._data;throw new DotLottieError("Invalid font data.")}async _fromUrlToBlob(t){return(await fetch(t)).blob()}_isArrayBuffer(t){return t instanceof ArrayBuffer}_isDataURL(t){return"string"==typeof t&&t.startsWith("data:")}_isBlob(t){return t instanceof Blob}},LottieAudio=class extends LottieAudioCommon{constructor(t){super(t)}},LottieFont=class extends LottieFontCommon{constructor(t){super(t)}},LottieImage=class extends LottieImageCommon{constructor(t){super(t)}},LottieAnimation=class extends LottieAnimationCommon{constructor(t){super(t)}async toBase64(){const t=await this.toArrayBuffer();if("undefined"==typeof window)return Buffer.from(t).toString("base64");const e=new Uint8Array(t).reduce(((t,e)=>t+String.fromCharCode(e)),"");return window.btoa(e)}async _extractImageAssets(){if(!this._data)throw new DotLottieError("Failed to extract image assets: Animation data does not exist");const t=this._data.assets;if(!t)throw new DotLottieError("Failed to extract image assets: No assets found inside animation");for(const e of t)if("w"in e&&"h"in e&&!("xt"in e)&&"p"in e){const t=e.p.split(",");if(!t.length||!t[0]||!t[1])break;let i=null;const a=await getExtensionTypeFromBase64(e.p);if(a){i=a;const t=`${e.id}.${i}`;this._imageAssets.push(new LottieImage({data:e.p,id:e.id,lottieAssetId:e.id,fileName:t,parentAnimations:[this]})),e.p=t,e.u="/i/",e.e=0}}return!1}async _extractAudioAssets(){if(!this._data)throw new DotLottieError("Failed to extract audio assets: Animation data does not exist");const t=this._data.assets;if(!t)throw new DotLottieError("Failed to extract image assets: No assets found inside animation");for(const e of t)if(isAudioAsset(e)){const t=e.p.split(",");if(!t.length||!t[0]||!t[1])break;let i=null;i=await getExtensionTypeFromBase64(e.p);const a=`${e.id}.${i}`;this._audioAssets.push(new LottieAudio({data:e.p,id:e.id,fileName:a,parentAnimations:[this]})),e.p=a,e.u="/u/",e.e=0}return!1}async _extractFontAssets(){if(!this._data)throw new DotLottieError("Failed to extract font assets: Animation data does not exist");const t=this._data.fonts?.list;if(!t)throw new DotLottieError("Failed to extract font assets: No fonts found inside animation");for(const e of t)if(e.fPath&&isFontDataUrl(e.fPath)){const t=e.fPath;let i=null;const a=await getExtensionTypeFromBase64(e.fPath);if(a){i=a;const o=`${e.fName}.${i}`;this._fontAssets.push(new LottieFont({data:t,id:e.fName,fileName:o,parentAnimations:[this]})),e.fPath=`/f/${o}`,e.origin=3}}return!1}},__read=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var a,o,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(a=n.next()).done;)r.push(a.value)}catch(t){o={error:t}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(o)throw o.error}}return r},__spreadArray=function(t,e){for(var i=0,a=e.length,o=t.length;i<a;i++,o++)t[o]=e[i];return t},VanilaConverter=function(){function t(t,e,i){this.document=t,this.glayScaleCalculator=e,this.resizer=i}return t.prototype.createCanvasRenderingContext2D=function(t,e){var i=this.document.createElement("canvas");i.width=t,i.height=e,i.setAttribute("style","image-rendering: -webkit-optimize-contrast; image-rendering: crisp-edges;");var a=i.getContext("2d");if(null===a)throw new ReferenceError("undefined CanvasRenderingContext2D");return a.mozImageSmoothingEnabled=!0,a.webkitImageSmoothingEnabled=!0,a.msImageSmoothingEnabled=!0,a.imageSmoothingEnabled=!0,a},t.prototype.convert=function(t){var e=this,i=new Image,a=new Promise((function(t){i.onload=function(){var a=e.createCanvasRenderingContext2D(i.width,i.height);a.drawImage(i,0,0,i.width,i.height);var o=a.getImageData(0,0,i.width,i.height).data;t(o)}})).then((function(a){return e.resizer.resize(a,i.width,i.height,t.width,t.height)})).then((function(t){var i=__spreadArray([],__read(Array(t.length/4).keys())).map((function(i){var a=4*i,o=__read([t[a],t[a+1],t[a+2]],3),n=o[0],r=o[1],s=o[2];return e.glayScaleCalculator(n,r,s)}));return new Uint8ClampedArray(i)}));return i.src=t.url.toString(),a},t}(),VanilaConverter_default=VanilaConverter,HashSource=function(){function t(t,e){void 0===e&&(e=8),this.url=t,this.hashSize=e,this.width=e+1,this.height=e}return t.prototype.calculateArea=function(){return this.width*this.height},t}(),HashSource_default=HashSource,import_lanczos=__toESM(require_dist3()),LanczosResizer=function(){function t(){}return t.prototype.resize=function(t,e,i,a,o){var n=new ImageDataSouce(e,i,t),r=new ImageDataSouce(a,o,new Uint8ClampedArray(a*o*4));return(0,import_lanczos.lanczos)(n,r),r.data},t}(),LanczosResizer_default=LanczosResizer,ImageDataSouce=function(){return function(t,e,i){this.width=t,this.height=e,this.data=i}}(),__read2=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var a,o,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(a=n.next()).done;)r.push(a.value)}catch(t){o={error:t}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(o)throw o.error}}return r},__spreadArray2=function(t,e){for(var i=0,a=e.length,o=t.length;i<a;i++,o++)t[o]=e[i];return t},Hash=function(){function t(t){if(t.split("").find((function(t){return"1"!==t&&"0"!==t})))throw new TypeError("Not bits.");this.rawHash=t}return t.prototype.getHammingDistance=function(t){if(this.rawHash.length!==t.rawHash.length)throw new TypeError("Not equal to hash length.");var e=t.rawHash.split("");return this.rawHash.split("").filter((function(t,i){return t!==(e[i]||"0")})).length},t.prototype.toString=function(){return this.calcuateHexadecimal(this.rawHash.split("").map((function(t){return"1"===t?1:0})))},t.prototype.arrayChunk=function(t,e){return __spreadArray2([],__read2(Array(Math.ceil(t.length/e)).keys())).map((function(i){return t.slice(i*e,i*e+e)}))},t.prototype.calcuateHexadecimal=function(t){return this.arrayChunk(t,4).map((function(t){return parseInt(t.join(""),2).toString(16)})).join("")},t}(),Hash_default=Hash,__read3=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var a,o,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(a=n.next()).done;)r.push(a.value)}catch(t){o={error:t}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(o)throw o.error}}return r},__spreadArray3=function(t,e){for(var i=0,a=e.length,o=t.length;i<a;i++,o++)t[o]=e[i];return t},HashGenerator=function(){function t(t){this.document=t}return t.prototype.generateByImage=function(t,e){e.width=t.width,e.height=t.height;var i=this.document.createElement("canvas").getContext("2d");if(null===i)throw new ReferenceError("undefined CanvasRenderingContext2D");return i.drawImage(e,0,0,t.width,t.height),this.generate(t,i)},t.prototype.generateByCanvasRenderingContext2D=function(t,e){var i=e.getImageData(0,0,t.width,t.height).data,a=new Uint8ClampedArray(__spreadArray3([],__read3(Array(i.length/4).keys())).map((function(t){return i[4*t]})));return this.generate(t,a)},t.prototype.generateByUint8ClampedArray=function(t,e){if(e.length!==t.calculateArea())throw new Error("Not convertable grayArray, convertable grayArray length is "+t.calculateArea());var i=Array.from(e).map((function(t,e,i){return t<=i[e+1]?1:0})).filter((function(e,i){return(i+1)%t.width!=0})).join("");return new Hash_default(i)},t.prototype.generate=function(t,e){if(e instanceof HTMLImageElement)return this.generateByImage(t,e);if(e instanceof CanvasRenderingContext2D)return this.generateByCanvasRenderingContext2D(t,e);if(e instanceof Uint8ClampedArray)return this.generateByUint8ClampedArray(t,e);throw new TypeError("Not generatable glay image source.")},t}(),HashGenerator_default=HashGenerator;function ITU_R601_2Method(t,e,i){return Math.round(299*t/1e3+587*e/1e3+114*i/1e3)}var __awaiter=function(t,e,i,a){return new(i||(i=Promise))((function(e,o){function n(t){try{s(a.next(t))}catch(t){o(t)}}function r(t){try{s(a.throw(t))}catch(t){o(t)}}function s(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i((function(t){t(a)}))).then(n,r)}s((a=a.apply(t,[])).next())}))},__generator=function(t,e){var i,a,o,n,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,a=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){r=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){r.label=n[1];break}if(6===n[0]&&r.label<o[1]){r.label=o[1],o=n;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(n);break}o[2]&&r.ops.pop(),r.trys.pop();continue}n=e.call(t,r)}catch(t){n=[6,t],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},DifferenceHashBuilder=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=window.document),null===t&&(t=new VanilaConverter_default(e,ITU_R601_2Method,new LanczosResizer_default)),this.dHashConverter=t,this.generator=new HashGenerator_default(e)}return t.prototype.build=function(t,e){return void 0===e&&(e=8),__awaiter(this,void 0,void 0,(function(){var i,a;return __generator(this,(function(o){switch(o.label){case 0:return i=new HashSource_default(t,e),[4,this.dHashConverter.convert(i)];case 1:return a=o.sent(),[2,this.generator.generate(i,a)]}}))}))},t}(),DifferenceHashBuilder_default=DifferenceHashBuilder,DotLottiePlugin=class{constructor(t){__publicField(this,"dotlottie"),__publicField(this,"_parallel",!1),this.dotlottie=void 0,t?.parallel&&(this._parallel=t.parallel)}install(t){this.dotlottie=t}uninstall(){this.dotlottie=void 0}get parallel(){return this._parallel}set parallel(t){this._parallel=t}async onBuild(){throw new DotLottieError("dotlottie-plugin build Not implemented!")}_requireDotLottie(t){if(!t)throw new DotLottieError("dotLottie context is null inside of duplicate image detector plugin.")}},DuplicateImageDetectorCommon=class extends DotLottiePlugin{async generatePhash(t){throw new DotLottieError("generatePhash(image: LottieImageCommon): Promise<Hash> is not implemented in concrete class.")}distanceTo(t,e){throw new DotLottieError("distanceTo(_imageHash: string, _targetImageHash: string): Promise<number> is not implemented in concrete class.")}async _createRecordOfDuplicates(){this._requireDotLottie(this.dotlottie);const t=[],e={};for(const e of this.dotlottie.animations)for(const i of e.imageAssets)t.push({excludeFromExport:!1,image:i,hash:await this.generatePhash(i)});for(const i of t)for(const a of t)i.image.lottieAssetId!==a.image.lottieAssetId&&!i.excludeFromExport&&!a.excludeFromExport&&i.hash&&a.hash&&this.distanceTo(i.hash,a.hash)<5&&(e[i.image.fileName]||e[a.image.fileName]?e[a.image.fileName]&&(e[a.image.fileName]?.find((t=>t.id===i.image.lottieAssetId))||(i.excludeFromExport=!0,e[a.image.fileName]?.push(i.image))):(a.excludeFromExport=!0,e[i.image.fileName]=[a.image]));return e}adjustDuplicateImageAssetPath(t,e){for(const i in e)i&&e[i]?.forEach((e=>{if(t.data){const a=t.data.assets;a&&a.forEach((t=>{if("w"in t&&"h"in t&&t.p===e.fileName){const e=i;t.p=e}}))}}))}async onBuild(){this._requireDotLottie(this.dotlottie);const t=await this._createRecordOfDuplicates();this.dotlottie.animations.forEach((e=>{this.adjustDuplicateImageAssetPath(e,t)}));const e={},i=this.dotlottie.getImages();for(const a in t)if(a)for(const t of i)t.fileName===a&&void 0!==t.data&&(e[a]=new LottieImage({data:t.data,id:t.id,lottieAssetId:t.lottieAssetId,fileName:t.fileName}));if(Object.keys(e).length!==Object.keys(t).length)throw new DotLottieError("The number of cloned images does not match the number of duplicate keys.");for(const i in t)i&&t[i]?.forEach((t=>{if(t.parentAnimations.length)for(const a of t.parentAnimations){a.imageAssets.splice(a.imageAssets.indexOf(t),1);const o=e[i];void 0!==o&&(a.imageAssets.push(o),o.parentAnimations.push(a))}}))}},DuplicateImageDetector=class extends DuplicateImageDetectorCommon{async generatePhash(t){const e=new DifferenceHashBuilder_default,i=new URL(await t.toDataURL());return(await e.build(i)).rawHash}distanceTo(t,e){const i=new Hash_default(t),a=new Hash_default(e);return i.getHammingDistance(a)}};async function toDotLottieV2(t){if("2"!==await getDotLottieVersion(new Uint8Array(t))){const e=new DotLottie,i=await(new DotLottieV1).fromArrayBuffer(t),a=i.animations.map((t=>t.id));for(const t of a){const a=await i.getAnimation(t,{inlineAssets:!0});a&&a.data&&e.addAnimation({data:a.data,id:t})}return await e.build(),e}return(new DotLottie).fromArrayBuffer(t)}var DotLottie=class t extends DotLottieCommon{constructor(t){if(super(t),this.enableDuplicateImageOptimization){const t=new DuplicateImageDetector;t.install(this),this._plugins.push(t)}}addAnimation(t){const e=new LottieAnimation(t);if(this._animationsMap.get(t.id))throw new DotLottieError("Duplicate animation id detected, aborting.");return this._animationsMap.set(e.id,e),this}async toBase64(t){const e=await this.toArrayBuffer(t),i=new Uint8Array(e).reduce(((t,e)=>t+String.fromCharCode(e)),"");return window.btoa(i)}async download(t,e){const i=await this.toBlob(e),a=URL.createObjectURL(i),o=document.createElement("a");o.href=a,o.download=t,o.style.display="none",document.body.append(o),o.click(),setTimeout((()=>{URL.revokeObjectURL(a),o.remove()}),1e3)}create(e){return new t(e)}async toArrayBuffer(t){const e=this._buildManifest(),i={"manifest.json":[strToU8(JSON.stringify(e)),{}]};for(const t of this.animations){const e=await t.toJSON();i[`a/${t.id}.json`]=[strToU8(JSON.stringify(e)),t.zipOptions];const a=t.imageAssets,o=t.audioAssets;for(const t of a){const e=await t.toDataURL();i[`i/${t.fileName}`]=[base64ToUint8Array(e),t.zipOptions]}for(const t of o){const e=await t.toDataURL();i[`u/${t.fileName}`]=[base64ToUint8Array(e),t.zipOptions]}const n=t.fontAssets;for(const t of n){const e=await t.toDataURL();i[`f/${t.fileName}`]=[base64ToUint8Array(e),t.zipOptions]}}for(const t of this.themes){const e=await t.toString();i[`t/${t.id}.json`]=[strToU8(e),t.zipOptions]}for(const t of this.stateMachines){const e=t.toString();i[`s/${t.id}.json`]=[strToU8(e),t.zipOptions]}return await new Promise(((e,a)=>{zip(i,t?.zipOptions||{},((t,i)=>{t?a(t):e(i.buffer)}))}))}async fromArrayBuffer(e){if("2"!==await getDotLottieVersion(new Uint8Array(e)))return toDotLottieV2(e);const i=new t;try{const t=await new Promise(((t,i)=>{unzip(new Uint8Array(e),((e,a)=>{e&&i(e),t(a)}))})),a=[],o=[],n=[];if(!(t["manifest.json"]instanceof Uint8Array))throw new DotLottieError("Invalid buffer");try{const e=JSON.parse(strFromU8(t["manifest.json"],!1));for(const r of Object.keys(t)){const s=strFromU8(t[r],!0);if(r.startsWith("a/")&&r.endsWith(".json")){const t=/a\/(.+)\.json/u.exec(r)?.[1];if(!t)throw new DotLottieError("Invalid animation id");const a=JSON.parse(s),o=e.animations.find((e=>e.id===t));if(void 0===o)throw new DotLottieError("Animation not found inside manifest");i.addAnimation({data:a,...o})}else if(r.startsWith("i/")){const t=/i\/(.+)\./u.exec(r)?.[1];if(!t)throw new DotLottieError("Invalid image id");let e=btoa(s);e=`data:image/${await getExtensionTypeFromBase64(e)};base64,${e}`,a.push(new LottieImage({id:t,lottieAssetId:t,data:e,fileName:r.split("/")[1]||""}))}else if(r.startsWith("u/")){const t=/u\/(.+)\./u.exec(r)?.[1];if(!t)throw new DotLottieError("Invalid image id");let e=btoa(s);e=`data:audio/${await getExtensionTypeFromBase64(e)};base64,${e}`,o.push(new LottieAudio({id:t,data:e,fileName:r.split("/")[1]||""}))}else if(r.startsWith("f/")){const t=/f\/(.+)\./u.exec(r)?.[1];if(!t)throw new DotLottieError("Invalid font id");let e=btoa(s);e=`data:font/${await getExtensionTypeFromBase64(e)};base64,${e}`,n.push(new LottieFont({id:t,data:e,fileName:r.split("/")[1]||""}))}else if(r.startsWith("t/")&&r.endsWith(".json")){const t=/t\/(.+)\.json/u.exec(r)?.[1];if(!t)throw new DotLottieError("Invalid theme id");e.themes?.forEach((e=>{e.id===t&&i.addTheme({id:e.id,name:e.name,data:JSON.parse(s)})}))}else if(r.startsWith("s/")&&r.endsWith(".json")){const t=/s\/(.+)\.json/u.exec(r)?.[1];if(!t)throw new DotLottieError("Invalid theme id");e.stateMachines?.forEach((e=>{e.id===t&&i.addStateMachine({id:e.id,name:e.name,data:JSON.parse(s)})}))}}for(const t of a)for(const e of i.animations)if(e.data){const i=e.data.assets;if(i)for(const a of i)"w"in a&&"h"in a&&a.p===t.fileName&&(t.parentAnimations.push(e),e.imageAssets.push(t))}for(const t of o)for(const e of i.animations)if(e.data){const i=e.data.assets;if(i)for(const a of i)isAudioAsset(a)&&a.p.includes(t.id)&&(t.parentAnimations.push(e),e.audioAssets.push(t))}for(const t of n)for(const e of i.animations)if(e.data){const i=e.data.fonts?.list;if(i)for(const a of i)a.fPath===`/f/${t.fileName}`&&(t.parentAnimations.push(e),e.fontAssets.push(t))}}catch(t){if(t instanceof Error)throw new DotLottieError(`Invalid manifest inside buffer! ${t.message}`)}}catch(t){if(t instanceof Error)throw new DotLottieError(t.message)}return i}},LottieTheme=class extends LottieThemeCommon{constructor(t){super(t)}},LottieStateMachine=class extends DotLottieStateMachineCommon{constructor(t){super(t)}},DotLottieCommonV1=class{constructor(t){__publicField(this,"_animationsMap",new Map),__publicField(this,"_plugins",[]),__publicField(this,"_author",PACKAGE_NAME),__publicField(this,"_description"),__publicField(this,"_generator",PACKAGE_NAME),__publicField(this,"_keywords"),__publicField(this,"_version","1"),__publicField(this,"_revision"),__publicField(this,"_customData"),__publicField(this,"enableDuplicateImageOptimization"),"string"==typeof t?.author&&(this._author=t.author),"string"==typeof t?.description&&(this._description=t.description),"string"==typeof t?.generator&&(this._generator=t.generator),"string"==typeof t?.keywords&&(this._keywords=t.keywords),"number"==typeof t?.revision&&(this._revision=t.revision),this.enableDuplicateImageOptimization=t?.enableDuplicateImageOptimization??!1}async toBase64(t=void 0){throw new DotLottieError("toBase64() method not implemented in concrete class!")}create(t){throw new DotLottieError("create() method not implemented in concrete class!")}async download(t,e=void 0){throw new DotLottieError("download(fileName:string) method not implemented in concrete class!")}addPlugins(...t){throw new DotLottieError("addPlugins(...plugins: DotLottieV1Plugin[]) not implemented in concrete class!")}addAnimation(t){throw new DotLottieError("addAnimation(animationOptions: AnimationOptions) not implemented in concrete class!")}async fromArrayBuffer(t){throw new DotLottieError("fromArrayBuffer(arrayBuffer: ArrayBuffer): Promise<DotLottieCommonV1> not implemented in concrete class!")}async toArrayBuffer(t=void 0){throw new DotLottieError("toArrayBuffer(): Promise<ArrayBuffer> is not implemented in concrete class!")}get plugins(){return this._plugins}get version(){return this._version}get revision(){return this._revision}get author(){return this._author}get description(){return this._description}get keywords(){return this._keywords}get generator(){return this._generator}get animations(){return Array.from(this._animationsMap.values())}get manifest(){return this._buildManifest()}get custom(){return this._customData}setCustomData(t){return this._customData=t??{},this}setAuthor(t){return this._author=t,this}setDescription(t){return this._description="string"==typeof t?t:"",this}setKeywords(t){return this._keywords="string"==typeof t?t:"DotLottieV1",this}setRevision(t){return this._revision=t,this}async _renameImage(t,e,i){for(const a of t.imageAssets)if(a.lottieAssetId===i){const i=a.fileName;if(await a.renameImage(e),!t.data)throw new DotLottieError("No animation data available.");const o=t.data.assets;if(!o)throw new DotLottieError("No image assets to rename.");for(const t of o)"w"in t&&"h"in t&&t.p===i&&(t.p=a.fileName)}}_generateMapOfOccurencesFromImageIds(){const t=new Map;return this.animations.forEach((e=>{e.imageAssets.forEach((e=>{if(t.has(e.lottieAssetId)){const i=t.get(e.lottieAssetId)??0;t.set(e.lottieAssetId,i+1)}else t.set(e.lottieAssetId,1)}))})),t}async _renameImageAssets(){const t=this._generateMapOfOccurencesFromImageIds();for(let e=this.animations.length-1;e>=0;e-=1){const i=this.animations.at(e);if(i)for(let e=i.imageAssets.length-1;e>=0;e-=1){const a=i.imageAssets.at(e);if(a){let e=t.get(a.lottieAssetId)??0;e>0&&(e-=1),t.set(a.lottieAssetId,e),e>0&&await this._renameImage(i,`${a.lottieAssetId}_${e}`,a.lottieAssetId)}}}}async _renameAudio(t,e,i){for(const a of t.audioAssets)if(a.id===i){if(await a.renameAudio(e),!t.data)throw new DotLottieError("No animation data available.");const o=t.data.assets;if(!o)throw new DotLottieError("No audio assets to rename.");for(const t of o)isAudioAsset(t)&&t.id===i&&(t.p=a.fileName)}}async _renameAudioAssets(){const t=new Map;this.animations.forEach((e=>{t.set(e.id,e.audioAssets)}));let e=0;t.forEach((t=>{e+=t.length}));for(let t=this.animations.length-1;t>=0;t-=1){const i=this.animations.at(t);if(i)for(let t=i.audioAssets.length-1;t>=0;t-=1){const a=i.audioAssets.at(t);a&&(await this._renameAudio(i,`audio_${e}`,a.id),e-=1)}}}_addLottieAnimation(t){if(this._animationsMap.get(t.id))throw new DotLottieError("Duplicate animation id detected, aborting.");return this._animationsMap.set(t.id,t),this}async _findAssetsAndInline(t){const e=t.data?.assets;if(!e)throw new DotLottieError("Failed to inline assets, the animation's assets are undefined.");const i=this.getImages(),a=this.getAudio();for(const t of e)if(isImageAsset(t))for(const e of i)e.fileName===t.p&&(t.e=1,t.u="",t.p=await e.toDataURL());else if(isAudioAsset(t))for(const e of a)e.fileName===t.p&&(t.e=1,t.u="",t.p=await e.toDataURL());return t}async getAnimation(t,e){if(!e?.inlineAssets)return this._animationsMap.get(t);let i=this._animationsMap.get(t);if(!i)throw new DotLottieError("Failed to find animation.");return i=await this._findAssetsAndInline(i),i}getAnimations(){return Array.from(this._animationsMap)}removeAnimation(t){const e=this._animationsMap.get(t);return e&&this._animationsMap.delete(e.id),this}getImages(){const t=[];return this.animations.map((e=>t.push(...e.imageAssets))),t}getAudio(){const t=[];return this.animations.map((e=>t.push(...e.audioAssets))),t}_buildManifest(){const t=Array.from(this._animationsMap.values()).map((t=>({id:t.id,...void 0!==t.autoplay&&{autoplay:t.autoplay},...void 0!==t.loop&&{loop:t.loop},...void 0!==t.speed&&{speed:t.speed},...void 0!==t.direction&&{direction:t.direction},...void 0!==t.playMode&&{playMode:t.playMode},...void 0!==t.hover&&{hover:t.hover},...void 0!==t.intermission&&{intermission:t.intermission},...void 0!==t.themeColor&&{themeColor:t.themeColor}})));return{version:this.version,generator:this.generator,author:this.author,...void 0!==this.keywords&&{keywords:this.keywords},...void 0!==this.revision&&{revision:this.revision},animations:t,...this.description&&""!==this.description.trim()?{description:this.description}:{},...this._customData&&0!==Object.keys(this._customData).length?{custom:this._customData}:{}}}async build(){this._buildManifest();for(const t of this.animations)await t.toJSON();this.animations.length>1&&(await this._renameImageAssets(),await this._renameAudioAssets());const t=[],e=[];for(const i of this.plugins)i.parallel?t.push(i):e.push(i);await Promise.all(t.map((async t=>t.onBuild())));for(const t of e)await t.onBuild();return this}async toBlob(t=void 0){const e=await this.toArrayBuffer(t);return new Blob([e],{type:"application/zip"})}async fromURL(t){if(!isValidURL(t))throw new DotLottieError("Invalid URL");try{const e=await fetch(t);if(!e.ok)throw new DotLottieError(e.statusText);const i=await e.arrayBuffer();return this.fromArrayBuffer(i)}catch(t){if(t instanceof Error)throw new DotLottieError(t.message)}throw new DotLottieError("Unknown error")}merge(...t){const e=this.create();for(const i of t)i.animations.forEach((t=>{t.data?e.addAnimation({id:t.id,data:t.data}):t.url&&e.addAnimation({id:t.id,url:t.url})}));return e}_requireValidAuthor(t){if("string"!=typeof t)throw new DotLottieError("Invalid author")}_requireValidDescription(t){if("string"!=typeof t)throw new DotLottieError("Invalid description")}_requireValidGenerator(t){if("string"!=typeof t)throw new DotLottieError("Invalid generator")}_requireValidKeywords(t){if("string"!=typeof t)throw new DotLottieError("Invalid keywords")}_requireValidVersion(t){if("string"!=typeof t)throw new DotLottieError("Invalid version")}_requireValidCustomData(t){if(!t)throw new DotLottieError("Invalid customData")}},PlayMode=(t=>(t.Bounce="bounce",t.Normal="normal",t))(PlayMode||{}),PlayModeSchema=nativeEnum(PlayMode),ManifestAnimationSchemaV1=object({id:string(),autoplay:optional(boolean()),loop:optional(union([boolean(),number()])),speed:optional(number()),direction:optional(union([literal(1),literal(-1)])),playMode:optional(PlayModeSchema),hover:optional(boolean()),intermission:optional(number()),themeColor:optional(string())}),ManifestSchemaV1=object({version:optional(string()),generator:optional(string()),activeAnimationId:optional(string()),animations:array(ManifestAnimationSchemaV1),author:optional(string()),custom:optional(record(string(),any())),description:optional(string()),keywords:optional(string()),revision:optional(number())}),LottieAnimationCommonV1=class{constructor(t){__publicField(this,"_data"),__publicField(this,"_id",""),__publicField(this,"_url"),__publicField(this,"_direction"),__publicField(this,"_speed"),__publicField(this,"_playMode"),__publicField(this,"_loop"),__publicField(this,"_autoplay"),__publicField(this,"_hover"),__publicField(this,"_intermission"),__publicField(this,"_themeColor"),__publicField(this,"_zipOptions"),__publicField(this,"_defaultActiveAnimation"),__publicField(this,"_imageAssets",[]),__publicField(this,"_audioAssets",[]),this._requireValidOptions(t),this._id=t.id,this._zipOptions=t.zipOptions??{},t.data&&(this._data=t.data),t.url&&(this._url=t.url),this._defaultActiveAnimation=t.defaultActiveAnimation??!1,"number"==typeof t.direction&&(this.direction=t.direction),"number"==typeof t.speed&&(this.speed=t.speed),"string"==typeof t.playMode&&(this.playMode=t.playMode),"boolean"!=typeof t.loop&&"number"!=typeof t.loop||(this.loop=t.loop),"boolean"==typeof t.autoplay&&(this.autoplay=t.autoplay),"boolean"==typeof t.hover&&(this.hover=t.hover),"number"==typeof t.intermission&&(this.intermission=t.intermission),"string"==typeof t.themeColor&&(this.themeColor=t.themeColor)}async toBase64(){throw new DotLottieError("lottie animation controls tobase64 not implemented!")}get zipOptions(){return this._zipOptions}set zipOptions(t){this._zipOptions=t}get id(){return this._id}set id(t){this._requireValidId(t),this._id=t}get imageAssets(){return this._imageAssets}set imageAssets(t){this._imageAssets=t}get audioAssets(){return this._audioAssets}set audioAssets(t){this._audioAssets=t}get data(){return this._data}set data(t){this._requireValidLottieData(t),this._data=t}get url(){return this._url}set url(t){this._requireValidUrl(t),this._url=t}get themeColor(){return this._themeColor}set themeColor(t){t&&this._requireValidThemeColor(t),this._themeColor=t}get direction(){return this._direction}set direction(t){this._direction=t}get speed(){return this._speed}set speed(t){"number"==typeof t&&this._requireValidSpeed(t),this._speed=t}get playMode(){return this._playMode}set playMode(t){"string"==typeof t&&this._requireValidPlayMode(t),this._playMode=t}get loop(){return this._loop}set loop(t){"number"!=typeof t&&"boolean"!=typeof t||this._requireValidLoop(t),this._loop=t}get autoplay(){return this._autoplay}set autoplay(t){"boolean"==typeof t&&this._requireValidAutoplay(t),this._autoplay=t}get defaultActiveAnimation(){return this._defaultActiveAnimation}set defaultActiveAnimation(t){this._defaultActiveAnimation=t}get hover(){return this._hover}set hover(t){"boolean"==typeof t&&this._requireValidHover(t),this._hover=t}get intermission(){return this._intermission}set intermission(t){"number"==typeof t&&this._requireValidIntermission(t),this._intermission=t}async toArrayBuffer(t){const e=await this.toJSON(t);return(new TextEncoder).encode(JSON.stringify(e)).buffer}async _extractImageAssets(){throw new DotLottieError("_extractImageAssets(): Promise<boolean> method not implemented in concrete class")}async _extractAudioAssets(){throw new DotLottieError("_extractAudioAssets(): Promise<boolean> method not implemented in concrete class")}async toBlob(t={}){const e=await this.toJSON(t);return new Blob([JSON.stringify(e)],{type:"application/json"})}async toJSON(t){if(this._url&&!this._data&&(this._data=await this._fromUrl(this._url)),this._requireValidLottieData(this._data),this._data.assets?.length&&(await this._extractImageAssets(),await this._extractAudioAssets(),t?.inlineAssets)){const t=this.data?.assets;if(!t)throw new DotLottieError("Failed to inline assets, the animation's assets are undefined.");const e=this.imageAssets,i=this.audioAssets;for(const a of t)if("w"in a&&"h"in a&&!("xt"in a)&&"p"in a)for(const t of e)t.fileName===a.p&&(a.e=1,a.u="",a.p=await t.toDataURL());else if(isAudioAsset(a))for(const t of i)t.fileName===a.p&&(a.e=1,a.u="",a.p=await t.toDataURL())}return this._data}async _fromUrl(t){const e=await fetch(t),i=await e.text();let a;try{a=JSON.parse(i)}catch(t){if(t instanceof Error)throw new DotLottieError(`${t.message}: Invalid json returned from url`)}return this._requireValidLottieData(a),a}_requireValidUrl(t){try{new URL(t||"")}catch(t){throw new DotLottieError("Invalid animation url")}}_requireValidLottieData(t){if(!["v","ip","op","layers","fr","w","h"].every((e=>Object.prototype.hasOwnProperty.call(t,e))))throw new DotLottieError("Received invalid Lottie data.")}_requireValidId(t){if(!t)throw new DotLottieError("Invalid animation id")}_requireValidDirection(t){if(-1!==t&&1!==t)throw new DotLottieError("Direction can only be -1 (backwards) or 1 (forwards)")}_requireValidIntermission(t){if(t<0||!Number.isInteger(t))throw new DotLottieError("intermission must be a positive number")}_requireValidLoop(t){if("number"==typeof t&&(!Number.isInteger(t)||t<0))throw new DotLottieError("loop must be a positive number or boolean")}_requireValidOptions(t){if(this._requireValidId(t.id),!t.data&&!t.url)throw new DotLottieError("No data or url provided.");t.data&&this._requireValidLottieData(t.data),t.url&&this._requireValidUrl(t.url),t.direction&&this._requireValidDirection(t.direction),t.intermission&&this._requireValidIntermission(t.intermission),t.loop&&this._requireValidLoop(t.loop)}_requireValidSpeed(t){if(void 0!==t&&("number"!=typeof t||t<0))throw new DotLottieError("Speed must be a non-negative number")}_requireValidPlayMode(t){const e=Object.values(PlayMode);if(void 0!==t&&!e.includes(t))throw new DotLottieError(`playMode must be one of: ${e.join(", ")}`)}_requireValidAutoplay(t){if(void 0!==t&&"boolean"!=typeof t)throw new DotLottieError("autoplay must be a boolean")}_requireValidHover(t){if(void 0!==t&&"boolean"!=typeof t)throw new DotLottieError("Hover must be a boolean")}_requireValidThemeColor(t){if(void 0!==t&&"string"!=typeof t)throw new DotLottieError("themeColor must be a string and start with #");if(void 0!==t&&!t.startsWith("#"))throw new DotLottieError("themeColor must be a string and start with #")}},LottieImageCommonV1=class{constructor(t){__publicField(this,"_data"),__publicField(this,"_id",""),__publicField(this,"_lottieAssetId",""),__publicField(this,"_fileName",""),__publicField(this,"_parentAnimations"),__publicField(this,"_zipOptions"),this._requireValidId(t.id),this._requireValidLottieAssetId(t.lottieAssetId),this._requireValidFileName(t.fileName),this._zipOptions=t.zipOptions??{},t.data&&(this._data=t.data),t.id&&(this._id=t.id),t.lottieAssetId&&(this._lottieAssetId=t.lottieAssetId),t.fileName&&(this._fileName=t.fileName),this._parentAnimations=t.parentAnimations||[]}get zipOptions(){return this._zipOptions}set zipOptions(t){this._zipOptions=t}_requireValidId(t){if(!t)throw new DotLottieError("Invalid image id")}_requireValidLottieAssetId(t){if(!t)throw new DotLottieError("Invalid Lottie Image Asset Id")}_requireValidFileName(t){if(!t)throw new DotLottieError("Invalid image fileName")}get fileName(){return this._fileName}set fileName(t){this._requireValidFileName(t),this._fileName=t}get id(){return this._id}set id(t){this._requireValidId(t),this._id=t}get lottieAssetId(){return this._lottieAssetId}set lottieAssetId(t){this._requireValidLottieAssetId(t),this._lottieAssetId=t}get data(){return this._data}set data(t){if(!t)throw new DotLottieError("Invalid data");this._data=t}get parentAnimations(){return this._parentAnimations}set parentAnimations(t){this._parentAnimations=t}async toDataURL(){if(this._data&&this._isDataURL(this._data))return this.data;const t=await this.toArrayBuffer();return dataUrlFromU8(new Uint8Array(t))}async renameImage(t){this._lottieAssetId=t;const e=await this.toDataURL(),i=await getExtensionTypeFromBase64(e);if(!i)throw new DotLottieError("File extension type could not be detected from asset file.");this.fileName=`${t}.${i}`}async toArrayBuffer(){return await(await this.toBlob()).arrayBuffer()}async toBlob(){if(!this._data)throw new DotLottieError("Invalid image data.");if(this._isDataURL(this._data)){const t=this._data,[e,i]=t.split(",");if((!e||!i)&&t.length)return new Blob([t]);if(!e||!i)throw new DotLottieError("Invalid image data.");const a=e.replace("data:","").replace(/;base64$/,"");return new Blob([i],{type:a})}if(this._isArrayBuffer(this._data))return new Blob([this._data]);if(this._isBlob(this._data))return this._data;throw new DotLottieError("Invalid image data.")}async _fromUrlToBlob(t){return(await fetch(t)).blob()}_isArrayBuffer(t){return t instanceof ArrayBuffer}_isDataURL(t){return"string"==typeof t&&t.startsWith("data:")}_isBlob(t){return t instanceof Blob}},LottieAudioCommonV1=class{constructor(t){__publicField(this,"_data"),__publicField(this,"_id",""),__publicField(this,"_url"),__publicField(this,"_fileName",""),__publicField(this,"_parentAnimations"),__publicField(this,"_zipOptions"),this._requireValidId(t.id),this._requireValidFileName(t.fileName),this._zipOptions=t.zipOptions??{},t.data&&(this._data=t.data),t.id&&(this._id=t.id),t.url&&(this._url=t.url),t.fileName&&(this._fileName=t.fileName),this._parentAnimations=t.parentAnimations||[]}get zipOptions(){return this._zipOptions}set zipOptions(t){this._zipOptions=t}get fileName(){return this._fileName}set fileName(t){if(!t)throw new DotLottieError("Invalid audio file name","ASSET_NOT_FOUND");this._fileName=t}get id(){return this._id}set id(t){if(!t)throw new DotLottieError("Invalid audio id","ASSET_NOT_FOUND");this._id=t}get data(){return this._data}set data(t){if(!t)throw new DotLottieError("Invalid data");this._data=t}get parentAnimations(){return this._parentAnimations}set parentAnimations(t){this._parentAnimations=t}async toDataURL(){if(this._data&&this._isDataURL(this._data))return this.data;const t=await this.toArrayBuffer();return dataUrlFromU8(new Uint8Array(t))}async renameAudio(t){this.id=t;const e=await this.toDataURL(),i=await getExtensionTypeFromBase64(e);if(!i)throw new DotLottieError("File extension type could not be detected from asset file.");this.fileName=`${t}.${i}`}async toArrayBuffer(){return await(await this.toBlob()).arrayBuffer()}async toBlob(){if(!this._data&&this._url&&(this._data=await this._fromUrlToBlob(this._url)),!this._data)throw new Error("Invalid data");if(this._isDataURL(this._data)){const t=this._data,[e,i]=t.split(",");if((!e||!i)&&t.length)return new Blob([t]);if(!e||!i)throw new Error("Invalid data");const a=e.replace("data:","").replace(/;base64$/,"");return new Blob([i],{type:a})}if(this._isArrayBuffer(this._data))return new Blob([this._data]);if(this._isBlob(this._data))return this._data;throw new Error("Invalid data")}async _fromUrlToBlob(t){return(await fetch(t)).blob()}_isArrayBuffer(t){return t instanceof ArrayBuffer}_isDataURL(t){return"string"==typeof t&&t.startsWith("data:")}_isBlob(t){return t instanceof Blob}_requireValidId(t){if(!t)throw new DotLottieError("Invalid audio id")}_requireValidFileName(t){if(!t)throw new DotLottieError("Invalid audio fileName")}},LottieAudioV1=class extends LottieAudioCommonV1{constructor(t){super(t)}},LottieImageV1=class extends LottieImageCommonV1{constructor(t){super(t)}},LottieAnimationV1=class extends LottieAnimationCommonV1{constructor(t){super(t)}async toBase64(){const t=await this.toArrayBuffer();if("undefined"==typeof window)return Buffer.from(t).toString("base64");const e=new Uint8Array(t).reduce(((t,e)=>t+String.fromCharCode(e)),"");return window.btoa(e)}async _extractImageAssets(){if(!this._data)throw new DotLottieError("Failed to extract image assets: Animation data does not exist");const t=this._data.assets;if(!t)throw new DotLottieError("Failed to extract image assets: No assets found inside animation");for(const e of t)if("w"in e&&"h"in e&&!("xt"in e)&&"p"in e){const t=e.p.split(",");if(!t.length||!t[0]||!t[1])break;let i=null;const a=await getExtensionTypeFromBase64(e.p);if(a){i=a;const t=`${e.id}.${i}`;this._imageAssets.push(new LottieImageV1({data:e.p,id:e.id,lottieAssetId:e.id,fileName:t,parentAnimations:[this]})),e.p=t,e.u="/images/",e.e=0}}return!1}async _extractAudioAssets(){if(!this._data)throw new DotLottieError("Failed to extract audio assets: Animation data does not exist");const t=this._data.assets;if(!t)throw new DotLottieError("Failed to extract image assets: No assets found inside animation");for(const e of t)if(isAudioAsset(e)){const t=e.p.split(",");if(!t.length||!t[0]||!t[1])break;let i=null;i=await getExtensionTypeFromBase64(e.p);const a=`${e.id}.${i}`;this._audioAssets.push(new LottieAudioV1({data:e.p,id:e.id,fileName:a,parentAnimations:[this]})),e.p=a,e.u="/audio/",e.e=0}return!1}},DotLottieV1Plugin=class{constructor(t){__publicField(this,"dotLottieV1"),__publicField(this,"_parallel",!1),this.dotLottieV1=void 0,t?.parallel&&(this._parallel=t.parallel)}install(t){this.dotLottieV1=t}uninstall(){this.dotLottieV1=void 0}get parallel(){return this._parallel}set parallel(t){this._parallel=t}async onBuild(){throw new DotLottieError("DotLottieV1-plugin build Not implemented!")}_requireDotLottieV1(t){if(!t)throw new DotLottieError("DotLottieV1 context is null inside of duplicate image detector plugin.")}},DuplicateImageDetectorCommon2=class extends DotLottieV1Plugin{async generatePhash(t){throw new DotLottieError("generatePhash(image: LottieImageCommonV1): Promise<Hash> is not implemented in concrete class.")}distanceTo(t,e){throw new DotLottieError("distanceTo(_imageHash: string, _targetImageHash: string): Promise<number> is not implemented in concrete class.")}async _createRecordOfDuplicates(){this._requireDotLottieV1(this.dotLottieV1);const t=[],e={};for(const e of this.dotLottieV1.animations)for(const i of e.imageAssets)t.push({excludeFromExport:!1,image:i,hash:await this.generatePhash(i)});for(const i of t)for(const a of t)i.image.lottieAssetId!==a.image.lottieAssetId&&!i.excludeFromExport&&!a.excludeFromExport&&i.hash&&a.hash&&this.distanceTo(i.hash,a.hash)<5&&(e[i.image.fileName]||e[a.image.fileName]?e[a.image.fileName]&&(e[a.image.fileName]?.find((t=>t.lottieAssetId===i.image.lottieAssetId))||(i.excludeFromExport=!0,e[a.image.fileName]?.push(i.image))):(a.excludeFromExport=!0,e[i.image.fileName]=[a.image]));return e}adjustDuplicateImageAssetPath(t,e){for(const i in e)i&&e[i]?.forEach((e=>{if(t.data){const a=t.data.assets;a&&a.forEach((t=>{if("w"in t&&"h"in t&&t.p===e.fileName){const e=i;t.p=e}}))}}))}async onBuild(){this._requireDotLottieV1(this.dotLottieV1);const t=await this._createRecordOfDuplicates();this.dotLottieV1.animations.forEach((e=>{this.adjustDuplicateImageAssetPath(e,t)}));const e={},i=this.dotLottieV1.getImages();for(const a in t)if(a)for(const t of i)t.fileName===a&&void 0!==t.data&&(e[a]=new LottieImageV1({data:t.data,id:t.id,lottieAssetId:t.lottieAssetId,fileName:t.fileName}));if(Object.keys(e).length!==Object.keys(t).length)throw new DotLottieError("The number of cloned images does not match the number of duplicate keys.");for(const i in t)i&&t[i]?.forEach((t=>{if(t.parentAnimations.length)for(const a of t.parentAnimations){a.imageAssets.splice(a.imageAssets.indexOf(t),1);const o=e[i];void 0!==o&&(a.imageAssets.push(o),o.parentAnimations.push(a))}}))}},DuplicateImageDetector2=class extends DuplicateImageDetectorCommon2{async generatePhash(t){const e=new DifferenceHashBuilder_default,i=new URL(await t.toDataURL());return(await e.build(i)).rawHash}distanceTo(t,e){const i=new Hash_default(t),a=new Hash_default(e);return i.getHammingDistance(a)}};async function toDotLottieV1(t){if("2"===await getDotLottieVersion(new Uint8Array(t))){const e=new DotLottieV1,i=await(new DotLottie).fromArrayBuffer(t),a=i.animations.map((t=>t.id));for(const t of a){const a=await i.getAnimation(t,{inlineAssets:!0});a&&a.data&&e.addAnimation({data:a.data,id:t})}return await e.build(),e}return(new DotLottieV1).fromArrayBuffer(t)}var DotLottieV1=class t extends DotLottieCommonV1{constructor(t){if(super(t),this.enableDuplicateImageOptimization){const t=new DuplicateImageDetector2;t.install(this),this._plugins.push(t)}}addAnimation(t){const e=new LottieAnimationV1(t);if(this._animationsMap.get(t.id))throw new DotLottieError("Duplicate animation id detected, aborting.");return this._animationsMap.set(e.id,e),this}async toBase64(t){const e=await this.toArrayBuffer(t),i=new Uint8Array(e).reduce(((t,e)=>t+String.fromCharCode(e)),"");return window.btoa(i)}async download(t,e){const i=await this.toBlob(e),a=URL.createObjectURL(i),o=document.createElement("a");o.href=a,o.download=t,o.style.display="none",document.body.append(o),o.click(),setTimeout((()=>{URL.revokeObjectURL(a),o.remove()}),1e3)}create(e){return new t(e)}async toArrayBuffer(t){const e=this._buildManifest(),i={"manifest.json":[strToU8(JSON.stringify(e)),{}]};for(const t of this.animations){const e=await t.toJSON();i[`animations/${t.id}.json`]=[strToU8(JSON.stringify(e)),t.zipOptions];const a=t.imageAssets,o=t.audioAssets;for(const t of a){const e=await t.toDataURL();i[`images/${t.fileName}`]=[base64ToUint8Array(e),t.zipOptions]}for(const t of o){const e=await t.toDataURL();i[`audio/${t.fileName}`]=[base64ToUint8Array(e),t.zipOptions]}}return await new Promise(((e,a)=>{zip(i,t?.zipOptions||{},((t,i)=>{t?a(t):e(i.buffer)}))}))}async fromArrayBuffer(e){if("2"===await getDotLottieVersion(new Uint8Array(e)))return toDotLottieV1(e);const i=new t;try{const t=await new Promise(((t,i)=>{unzip(new Uint8Array(e),((e,a)=>{e&&i(e),t(a)}))})),a=[],o=[];if(!(t["manifest.json"]instanceof Uint8Array))throw new DotLottieError("Invalid buffer");try{const e=JSON.parse(strFromU8(t["manifest.json"],!1)),{author:n,custom:r,description:s,keywords:c}=e;n&&(this._requireValidAuthor(n),i.setAuthor(n)),r&&(this._requireValidCustomData(r),i.setCustomData(r)),s&&(this._requireValidDescription(s),i.setDescription(s)),c&&(this._requireValidKeywords(c),i.setKeywords(c));for(const n of Object.keys(t)){const r=strFromU8(t[n],!0);if(n.startsWith("animations/")&&n.endsWith(".json")){const t=/animations\/(.+)\.json/u.exec(n)?.[1];if(!t)throw new DotLottieError("Invalid animation id");const a=JSON.parse(r),o=e.animations.find((e=>e.id===t));if(void 0===o)throw new DotLottieError("Animation not found inside manifest");i.addAnimation({data:a,...o})}else if(n.startsWith("images/")){const t=/images\/(.+)\./u.exec(n)?.[1];if(!t)throw new DotLottieError("Invalid image id");let e=btoa(r);e=`data:image/${await getExtensionTypeFromBase64(e)};base64,${e}`,a.push(new LottieImageV1({id:t,lottieAssetId:t,data:e,fileName:n.split("/")[1]||""}))}else if(n.startsWith("audio/")){const t=/audio\/(.+)\./u.exec(n)?.[1];if(!t)throw new DotLottieError("Invalid image id");let e=btoa(r);e=`data:audio/${await getExtensionTypeFromBase64(e)};base64,${e}`,o.push(new LottieAudioV1({id:t,data:e,fileName:n.split("/")[1]||""}))}}for(const t of a)for(const e of i.animations)if(e.data){const i=e.data.assets;if(i)for(const a of i)"w"in a&&"h"in a&&a.p===t.fileName&&(t.parentAnimations.push(e),e.imageAssets.push(t))}for(const t of o)for(const e of i.animations)if(e.data){const i=e.data.assets;if(i)for(const a of i)isAudioAsset(a)&&a.p.includes(t.id)&&(t.parentAnimations.push(e),e.audioAssets.push(t))}}catch(t){if(t instanceof Error)throw new DotLottieError(`Invalid manifest inside buffer! ${t.message}`)}}catch(t){if(t instanceof Error)throw new DotLottieError(t.message)}return i}};function makeDotLottie(t,e){return"v1"===t?new DotLottieV1(e):new DotLottie(e)}
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/export{ActionSchema,BooleanGuardSchema,BooleanInputSchema,ClickSchema,DotLottie,DotLottieCommon,DotLottieCommonV1,DotLottieError,DotLottieStateMachineCommon,DotLottieStateMachineSchema,DotLottieV1,ErrorCodes,EventGuardSchema,EventInputSchema,GlobalStateSchema,GuardSchema,InitialObjectSchema,InputSchema,InputsSchema,InteractionSchema,InteractionsSchema,LottieAnimation,LottieAnimationCommon,LottieAnimationCommonV1,LottieAnimationV1,LottieAudio,LottieAudioCommon,LottieAudioCommonV1,LottieAudioV1,LottieFont,LottieFontCommon,LottieImage,LottieImageCommon,LottieImageCommonV1,LottieImageV1,LottieStateMachine,LottieTheme,LottieThemeCommon,ManifestAnimationSchema,ManifestAnimationSchemaV1,ManifestSchema,ManifestSchemaV1,ManifestStateMachineSchema,ManifestThemeSchema,NumericGuardSchema,NumericInputSchema,OnCompleteSchema,OnLoopCompleteSchema,PlayMode,PlayModeSchema,PlaybackStateSchema,PointerDownSchema,PointerEnterSchema,PointerExitSchema,PointerMoveSchema,PointerUpSchema,RulesSchema,StateSchema,StatesSchema,StringGuardSchema,StringInputSchema,ThemeDataSchema,TransitionSchema,TransitionTransitionSchema,TransitionsSchema,TweenedTransitionSchema,base64ToUint8Array,dataUrlFromU8,getAllAudio,getAnimation,getAnimations,getAudio,getDotLottieVersion,getExtensionTypeFromBase64,getFont,getFonts,getImage,getImages,getManifest,getMimeTypeFromBase64,getMimeTypeFromUint8Data,getStateMachine,getStateMachines,getTheme,getThemes,inlineAudioAssets,inlineFontAssets,inlineImageAssets,isAudioAsset,isFontAsset,isFontDataUrl,isImageAsset,isValidURL,loadFromArrayBuffer,loadFromURL,makeDotLottie,toDotLottieV1,toDotLottieV2,unzipDotLottie,unzipDotLottieFile,validateDotLottie};
//# sourceMappingURL=/sm/276c41ca24747513d51c3ea67ec1695dabbe86ebd48e18b2a9ba22b4ee0c34f1.map